<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>胖子的博客</title>
  
  <subtitle>zhaoyu&#39;s blog</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://snzhaoyua.github.io/"/>
  <updated>2019-09-26T10:02:32.472Z</updated>
  <id>https://snzhaoyua.github.io/</id>
  
  <author>
    <name>zhaoyu025@gmail.com</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>suse11sp1 编译 apache 2.4.34</title>
    <link href="https://snzhaoyua.github.io/2019/09/26/2019/20190418%20suse11sp1%20%E7%BC%96%E8%AF%91%20apache%202.4.34/"/>
    <id>https://snzhaoyua.github.io/2019/09/26/2019/20190418 suse11sp1 编译 apache 2.4.34/</id>
    <published>2019-09-26T10:02:32.588Z</published>
    <updated>2019-09-26T10:02:32.472Z</updated>
    
    <content type="html"><![CDATA[<div id="preamble"><div class="sectionbody"><div class="paragraph"><p>背景：suse 11 sp1 机器编译安装带有指定模块的 apache 2.4.34. 暂时没有bicp代码访问权限，先放这里== 第一步 安装openssl</p></div><div class="listingblock"><div class="content"><pre>cd /data/bicpinstall/tar zxvf openssl-1.1.0i.tar.gzcd openssl-1.1.0iexport LDFLAGS=-ldlexport LIBPATH="/data/bicpinstall/ssl"export LIBS="-L/data/bicpinstall/ssl"export SSL_LIBS="-L/data/bicpinstall/ssl"export CPPFLAGS="-I/data/bicpinstall/ssl/include/openssl"./config --prefix=/data/bicpinstall/ssl sharedmake &amp;&amp; make installrm -rf /data/bicpinstall/ssl/ssl/man</pre></div></div></div></div><div class="sect1"><h2 id="_第二步_生成证书">第二步 生成证书</h2><div class="sectionbody"><div class="listingblock"><div class="content"><pre>cd /data/bicpinstall/ssl/binopenssl genrsa -passout pass:cHpxHUm+v5teANoYurlMvA2+Gdg+ifm -des3 -out server.key 1024openssl req -new -out server.csr -key server.key -passin pass:cHpxHUm+v5teANoYurlMvA2+Gdg+ifm -passout pass:cHpxHUm+v5teANoYurlMvA2+Gdg+ifm -subj /C=CN/O=huawei/CN=10.139.200.36 -config ../ssl/openssl.cnfopenssl x509 -req -days 3650 -in server.csr -signkey server.key -out server.crt -passin pass:cHpxHUm+v5teANoYurlMvA2+Gdg+ifmopenssl pkcs12 -export -out server.pfx -inkey server.key -in server.crt -passin pass:cHpxHUm+v5teANoYurlMvA2+Gdg+ifm -passout pass:cHpxHUm+v5teANoYurlMvA2+Gdg+ifm</pre></div></div></div></div><div class="sect1"><h2 id="_第三步_安装_httpd_2_4_34_依赖的_apr_和_apr_util">第三步 安装 httpd 2.4.34 依赖的 apr 和 apr-util</h2><div class="sectionbody"><div class="paragraph"><p>该部分不再捆绑发布，需要自行安装，版本需要 1.5 以上，部分功能需要 1.6 以上，版本要求见https://www.apache.org/dist/httpd/Announcement2.4.html</p></div><div class="listingblock"><div class="content"><pre>cd /data/bicpinstall/tar zxvf apr-1.6.3.tar.gztar zxvf apr-util-1.6.1.tar.gzaprcd /data/bicpinstall/apr-1.6.3/./configure --prefix=/data/bicpinstall/httpd-2.4.34/srclib/aprmake &amp; make installapr-utilsexpat （apr-utils依赖 libexpat，https://www.apache.org/dist/apr/CHANGES-APR-UTIL-1.6）cd /data/bicpinstall/tar xvjf expat-2.2.5.tar.bz2cd expat-2.2.5./configure --prefix=/data/bicpinstall/httpd-2.4.34/srclib/expatmake &amp; make installcd /data/bicpinstall/apr-util-1.6.1./configure --prefix=/data/bicpinstall/httpd-2.4.34/srclib/apr-util --with-apr=/data/bicpinstall/httpd-2.4.34/srclib/apr --with-expat=/data/bicpinstall/httpd-2.4.34/srclib/expatmake &amp; make install</pre></div></div></div></div><div class="sect1"><h2 id="_第四步_安装_pcre_下载地址_a_href_https_ftp_pcre_org_pub_pcre_class_bare_https_ftp_pcre_org_pub_pcre_a">第四步 安装 pcre，下载地址(<a href="https://ftp.pcre.org/pub/pcre/" class="bare" target="_blank" rel="noopener">https://ftp.pcre.org/pub/pcre/</a>)</h2><div class="sectionbody"><div class="listingblock"><div class="content"><pre>tar zxvf pcre-8.42.tar.gzcd /data/bicpinstall/pcre-8.42./configure --prefix=/data/bicpinstall/httpd-2.4.34/srclib/pcremake &amp;&amp; make install</pre></div></div><div class="paragraph"><p>安装 zlib，下载地址(<a href="https://zlib.net/zlib-1.2.11.tar.gz" class="bare" target="_blank" rel="noopener">https://zlib.net/zlib-1.2.11.tar.gz</a>)直接 ./configure &amp;&amp; make &amp;&amp; make install</p></div></div></div><div class="sect1"><h2 id="_第五步_编译安装_httpd">第五步 编译安装 httpd</h2><div class="sectionbody"><div class="listingblock"><div class="content"><pre>cd /data/bicpinstall/httpd-2.4.34./configure --prefix=/data/bicpinstall/apache --with-ssl=/data/bicpinstall/ssl --with-apr=/data/bicpinstall/httpd-2.4.34/srclib/apr --with-apr-util=/data/bicpinstall/httpd-2.4.34/srclib/apr-util --with-pcre=/data/bicpinstall/httpd-2.4.34/srclib/pcre --enable-headers=shared --enable-rewrite=shared --enable-proxy=shared --enable-proxy-connect=shared --enable-proxy-ftp=shared --enable-proxy-http=shared --enable-proxy-scgi=shared --enable-proxy-ajp=shared --enable-proxy-balancer=shared --enable-ssl=shared --enable-deflate=sharedmake &amp;&amp; make install</pre></div></div></div></div><div class="sect1"><h2 id="_第六步_压缩包">第六步 压缩包</h2><div class="sectionbody"><div class="listingblock"><div class="content"><pre>cd /data/bicpinstall/mkdir apache/libcp -P /data/bicpinstall/httpd-2.4.34/srclib/apr/lib/libapr-1.so* data/bicpinstall/apache/lib/cp -P /data/bicpinstall/httpd-2.4.34/srclib/apr-util/lib/libaprutil-1.so* data/bicpinstall/apache/lib/cp -P /data/bicpinstall/httpd-2.4.34/srclib/expat/lib/libexpat.so* data/bicpinstall/apache/lib/cp -r /data/bicpinstall/ssl /data/bicpinstall/apache/libcd /data/bicpinstall/apache/manual/mod; rm -rf index.html*cd /data/bicpinstall/apache/manual/rewrite; rm -rf index.html*cd /data/bicpinstall/apache/manual; rm -rf index.html*cd /data/bicpinstall/apache/manual/ssl; rm -rf index.html*cd /data/bicpinstall/apache/manual/programs; rm -rf index.html*cd /data/bicpinstall/apache/manual/developer;rm -rf index.html*cd /data/bicpinstall/apache/manual/misc; rm -rf index.html*cd /data/bicpinstall/apache/manual/howto; rm -rf index.html*cd /data/bicpinstall/apache/manual/platform; rm -rf index.html*cd /data/bicpinstall/apache/manual/faq; rm -rf index.html*cd /data/bicpinstall/apache/manual/vhosts; rm -rf index.html*cd /data/bicpinstall/apache/htdocs; rm -rf index.html*cd /data/bicpinstall/apache/cgi-bin;rm -rf *zip -r apache.zip apache</pre></div></div><div class="sect2"><h3 id="_附录一_部分软件">附录一 部分软件</h3><div class="listingblock"><div class="content"><pre>apr-1.6.3.tar.gzapr-util-1.6.1.tar.gzexpat-2.2.5.tar.bz2.remove.aschttpd-2.4.34.tar.gzopenssl-1.1.0i.tar.gzpcre-8.42.tar.gzzlib-1.2.11.tar.gz</pre></div></div><div class="sect3"><h4 id="_附录二_部分编译工具版本或环境">附录二 部分编译工具版本或环境</h4><div class="listingblock"><div class="content"><pre>cat /etc/SuSE-releaseSUSE Linux Enterprise Server 11 (x86_64)VERSION = 11PATCHLEVEL = 1gcc --versiongcc (SUSE Linux) 4.3.4 [gcc-4_3-branch revision 152973]Copyright (C) 2008 Free Software Foundation, Inc.This is free software; see the source for copying conditions.  There is NOwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.gunzip --versiongzip 1.3.12Copyright (C) 2007 Free Software Foundation, Inc.Copyright (C) 1993 Jean-loup Gailly.This is free software.  You may redistribute copies of it under the terms ofthe GNU General Public License &lt;http://www.gnu.org/licenses/gpl.html&gt;.There is NO WARRANTY, to the extent permitted by law.Written by Jean-loup Gailly.make --versionGNU Make 3.81Copyright (C) 2006  Free Software Foundation, Inc.This is free software; see the source for copying conditions.There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE.This program built for x86_64-unknown-linux-gnu</pre></div></div></div></div><div class="sect2"><h3 id="_附录三_错误解决">附录三 错误解决</h3><div class="listingblock"><div class="content"><pre>报错：/bin/sh: gcc: command not foundmake[1]: *** [crypto/aes/aes-x86_64.o] Error 127make[1]: Leaving directory `/data/bicpinstall/openssl-1.1.0i'make: *** [all] Error 2解决：安装gcc报错：checking for APR... noconfigure: error: APR not found.  Please read the documentation.报错： pcre-config for libpcre not found. PCRE is required and available from http://pcre.org/ 解决：见编译指导.md报错：checking dirent.h presence... yeschecking for dirent.h... yeschecking windows.h usability... nochecking windows.h presence... nochecking for windows.h... noconfigure: error: Invalid C++ compiler or C++ compiler flags 解决： zypper in gcc-c++报错： checking for zlib location... not foundchecking whether to enable mod_deflate... configure: error: mod_deflate has been requested but can not be built due to prerequisite failures 解决：编译安装zlib报错：checking whether to enable mod_deflate... checking dependencies  adding "-I/lib64/include" to INCLUDES  setting MOD_INCLUDES to "-I/lib64/include"  adding "-L/lib64/lib" to LDFLAGS  setting ap_zlib_ldflags to "-L/lib64/lib"  adding "-lz" to LIBSchecking for zlib library... not foundconfigure: error: ... Error, zlib was missing or unusable 解决：安装 zlib报错：od_proxy_balancer.c &amp;&amp; touch mod_proxy_balancer.slomod_proxy_balancer.c:25:24: error: apr_escape.h: No such file or directorymod_proxy_balancer.c: In function 'make_server_id':mod_proxy_balancer.c:779: warning: implicit declaration of function 'apr_pescape_hex'mod_proxy_balancer.c:779: warning: return makes pointer from integer without a castmake[4]: *** [mod_proxy_balancer.slo] Error 1make[4]: Leaving directory `/data/bicpinstall/httpd-2.4.34/modules/proxy'make[3]: *** [shared-build-recursive] Error 1make[3]: Leaving directory `/data/bicpinstall/httpd-2.4.34/modules/proxy'make[2]: *** [shared-build-recursive] Error 1make[2]: Leaving directory `/data/bicpinstall/httpd-2.4.34/modules'make[1]: *** [shared-build-recursive] Error 1make[1]: Leaving directory `/data/bicpinstall/httpd-2.4.34'make: *** [all-recursive] Error 1 解决：安装 apr-util报错：xml/apr_xml.c:35:19: error: expat.h: No such file or directoryxml/apr_xml.c:66: error: expected specifier-qualifier-list before ‘XML_Parser’xml/apr_xml.c: In function ‘cleanup_parser’:xml/apr_xml.c:364: error: ‘apr_xml_parser’ has no member named ‘xp’xml/apr_xml.c:365: error: ‘apr_xml_parser’ has no member named ‘xp’xml/apr_xml.c: At top level:xml/apr_xml.c:384: error: expected ‘;’, ‘,’ or ‘)’ before ‘*’ tokenxml/apr_xml.c: In function ‘apr_xml_parser_create’:xml/apr_xml.c:401: error: ‘apr_xml_parser’ has no member named ‘xp’xml/apr_xml.c:402: error: ‘apr_xml_parser’ has no member named ‘xp’xml/apr_xml.c:410: error: ‘apr_xml_parser’ has no member named ‘xp’xml/apr_xml.c:411: error: ‘apr_xml_parser’ has no member named ‘xp’xml/apr_xml.c:412: error: ‘apr_xml_parser’ has no member named ‘xp’xml/apr_xml.c:424: error: ‘apr_xml_parser’ has no member named ‘xp’xml/apr_xml.c:424: error: ‘default_handler’ undeclared (first use in this function)xml/apr_xml.c:424: error: (Each undeclared identifier is reported only once 解决：安装 expat，方法见上报错：aclocal: couldn't open directory `m4': No such file or directory解决 直接在当前目录 mkdir m4</pre></div></div></div></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;背景：suse 11 sp1 机器编译安装带有指定模块的 apache 2.4.34. 暂时没有bicp代码访问权限，先放这里
== 
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="[object Object]" scheme="https://snzhaoyua.github.io/tags/object-Object/"/>
    
  </entry>
  
  <entry>
    <title>自研数据库主备切换的一个bug记录</title>
    <link href="https://snzhaoyua.github.io/2019/09/26/20190810_%E8%87%AA%E7%A0%94%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%BB%E5%A4%87%E5%88%87%E6%8D%A2%E7%9A%84%E4%B8%80%E4%B8%AAbug%E8%AE%B0%E5%BD%95/"/>
    <id>https://snzhaoyua.github.io/2019/09/26/20190810_自研数据库主备切换的一个bug记录/</id>
    <published>2019-09-26T07:09:55.741Z</published>
    <updated>2019-09-26T07:09:55.741Z</updated>
    
    <content type="html"><![CDATA[<div class="sect1"><h2 id="_自研数据库主备切换的一个bug记录">自研数据库主备切换的一个bug记录</h2><div class="sectionbody"><div class="paragraph"><p>还是要给自研数据库的人点个赞，以前可能有人要问，业界有mysql，有oracle，有postgresql，大量的收费免费数据库，你们为什么要自己开发数据库？相信过了今年，不会再有人问这个问题了。自研数据库虽然具体细节不能透露，但是其只有6m的安装包大小，完美支持与oracle对接并同步的特性，兼容sql标准，支持python，c，java，支持多个主备，简单如mysql的配置，简单的容灾能力，支持方便的升级等等，还是很有竞争力。</p></div></div></div><div class="sect1"><h2 id="_主备同步的bug">主备同步的bug</h2><div class="sectionbody"><div class="paragraph"><p>那么bug是什么呢？该数据库在一主一备的情况下，有两种手段可以进行主备倒换：1. switchover2. failoverswitchover的场景是，如果主机和备机都正常，想手动触发主备倒换；failover的场景是，如果主机宕机了，备机需要容灾，提升为主机。</p></div><div class="paragraph"><p>这个bug出现在failover的情况。在failover的场景，备机已经升为主机，但是如果主机又恢复，这个时候会出现双主的现象，就需要将其降为备（demote）。问题是，在demote后，数据库必然出现主备不一致的情况，导致发生该数据库一个著名的异常情况needrepair，而且恢复方案需要删除数据重建，因此没人愿意写自动脚本处理，需要手工干预。</p></div></div></div><div class="sect1"><h2 id="_问题定位">问题定位</h2><div class="sectionbody"><div class="paragraph"><p>我们首先快速排查自己触发切换代码，在排查后将问题范围指向该数据库本身；首先，主备不一致的情况，是可以在日志中查询到的。该数据库，在主机降备成功后的十秒钟左右，会打印一行类似如下的信息：standby redo point(1/1422) is faster than primary(2/1421)，need repair&#8230;&#8203;很清晰，说新的备机redo日志比主机要快。那么就是要找出，多出来的这个操作，到底是什么？</p></div><div class="paragraph"><p>路线分为两路：1. 通过解析redo日志，查看操作内容2. 通过其它日志手段，继续确认及排查</p></div><div class="paragraph"><p>由于环境与我们开发环境的网络较为复杂，速度也比较慢，而该redo日志有1个G，传输要1个小时。因此在等待传输的间隙，我们走路线2.</p></div><div class="paragraph"><p>通过类似以下命令开启audit日志以及debug日志。</p></div><div class="listingblock"><div class="content"><pre>alter system set audit_level=15;alter system set _log_level=255;</pre></div></div><div class="paragraph"><p>最终搜索通过debug日志，查到有insert语句在执行：cat debug.log|grep -i insert -C 2</p></div><div class="paragraph"><p>通过查询数据库的job，发现开启了wsr性能收集job：</p></div><div class="listingblock"><div class="content"><pre>select * from dba_jobs;</pre></div></div><div class="paragraph"><p>关闭该任务后，问题消失。自研数据库部门的人虽然确认问题，但是始终想不通，明明在停止和切换数据库的时间节点，已经停止wsr收集，为何还会导致该问题出现，该问题虽然不属于我们的范畴，但是以往写并发以及过程控制要求比较严格的场景的经验告诉我，自研数据库这块的job，包括wsr以及用户自定义的job的逻辑，都需要再仔细审视一下。</p></div></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_自研数据库主备切换的一个bug记录&quot;&gt;自研数据库主备切换的一个bug记录&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;还是要给自研数据库的人点个赞，以
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="数据库" scheme="https://snzhaoyua.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="oracle" scheme="https://snzhaoyua.github.io/tags/oracle/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://snzhaoyua.github.io/2019/09/22/test/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/test/</id>
    <published>2019-09-22T04:56:05.256Z</published>
    <updated>2019-09-19T11:55:41.922Z</updated>
    
    <content type="html"><![CDATA[#!/usr/bin/env nodevar arguments = process.argv.splice(2);var file = arguments[0]var showdown  = require('showdown'),    converter = new showdown.Converter(),    fs = require('fs'),    text = fs.readFileSync(file, "utf8"),    html = converter.makeHtml(text);console.log(html)]]></content>
    
    <summary type="html">
    
      
      
        #!/usr/bin/env node

var arguments = process.argv.splice(2);
var file = arguments[0]
var showdown  = require(&#39;showdown&#39;),
    converter = ne
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Hive 2.3.3 安装常见问题</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181013%20Hive%202.3.3%20%E5%AE%89%E8%A3%85%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181013 Hive 2.3.3 安装常见问题/</id>
    <published>2019-09-22T04:56:05.256Z</published>
    <updated>2019-09-19T03:41:58.618Z</updated>
    
    <content type="html"><![CDATA[<h1 id="remote-模式最小配置"><a href="#remote-模式最小配置" class="headerlink" title="remote 模式最小配置"></a>remote 模式最小配置</h1><pre><code class="xml"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span><span class="meta">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span><span class="tag">&lt;<span class="name">configuration</span>&gt;</span><span class="tag">&lt;<span class="name">property</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://192.168.47.128:3306/hive?createDatabaseIfNotExist=true<span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span><span class="tag">&lt;<span class="name">property</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span><span class="tag">&lt;<span class="name">property</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span><span class="tag">&lt;<span class="name">property</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span>km717070<span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></code></pre><h1 id="安装问题"><a href="#安装问题" class="headerlink" title="安装问题"></a>安装问题</h1><ol><li><p>remote 模式报错 Java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient<br>解决：hive 需要先 <code>hive --service metastore</code> 先启动 thrift server，才能访问 mysql<br>参考：<a href="https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin#AdminManualMetastoreAdmin-RemoteMetastoreDatabase" target="_blank" rel="noopener">官方手册：Hive Metastore 配置</a><br>理解：mysql 为 metastore 的 database， Thrift Server 为 metastore 的服务器</p></li><li><p>hive –service metastore 启动报错 Unable to open a test connection to the given database<br>解决：mysql 的配置有问题<br>场景1：mysql 只允许本地访问<br>场景2：mysql 白名单未添加相应机器<br>参考：  </p><blockquote><p><a href="/2018/10/13/">如何确定 mysql 使用的配置文件</a><br><a href="/2018/10/13/mysql 访问常见问题">mysql 访问常见问题</a><br><a href="http://hadooptutorial.info/unable-open-test-connection-given-database/" target="_blank" rel="noopener">Unable to open a test connection to the given database</a>  </p></blockquote></li><li><p>报错 Version infomation not found in metastore<br>原因：hive 0.12 以后版本会验证 metastore version，metastore 中无该信息，因此无法访问<br>解决：schematool -dbType mysql -initSchema 刷库</p></li><li><p>警告 ssl 连接 mysql 的信息<br>jdbc 连接串添加 &amp;useSSL=false 即可，注意在 xml 中的转义（写成 <code>&amp;amp;useSSL=false</code>）。</p></li><li><p>hive on mr is deprecated in hive 2, consider using a different execution engine like spark. or using a hive 1.x version<br><a href="https://www.slideshare.net/MichTalebzadeh1/query-engines-for-hive-mr-spark-tez-with-llap-considerations" target="_blank" rel="noopener">hive spark tez 对比</a></p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;remote-模式最小配置&quot;&gt;&lt;a href=&quot;#remote-模式最小配置&quot; class=&quot;headerlink&quot; title=&quot;remote 模式最小配置&quot;&gt;&lt;/a&gt;remote 模式最小配置&lt;/h1&gt;&lt;pre&gt;&lt;code class=&quot;xml&quot;&gt;&lt;span 
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="BigData" scheme="https://snzhaoyua.github.io/tags/BigData/"/>
    
      <category term="Hive" scheme="https://snzhaoyua.github.io/tags/Hive/"/>
    
  </entry>
  
  <entry>
    <title>如何对 centos 7 分区进行扩容</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181013%20%E5%A6%82%E4%BD%95%E5%AF%B9%20centos%207%20%E5%88%86%E5%8C%BA%E8%BF%9B%E8%A1%8C%E6%89%A9%E5%AE%B9/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181013 如何对 centos 7 分区进行扩容/</id>
    <published>2019-09-22T04:56:05.256Z</published>
    <updated>2019-09-19T03:41:58.622Z</updated>
    
    <content type="html"><![CDATA[<h4 id="识别分区类型"><a href="#识别分区类型" class="headerlink" title="识别分区类型"></a>识别分区类型</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l</span><br></pre></td></tr></table></figure><p>在 Id 一列可以看到分区类型为<code>8e</code> <code>83</code>等十进制数值，<code>8e</code>代表该分区由 Linux LVM 管理，适用本文的扩容方法，如果你的分区类型为<code>83</code>，代表其是 Linux Native Partion，可以参考<a href>另一篇博文（尚未书写）</a>。</p><h4 id="虚拟机管理软件增加物理磁盘大小"><a href="#虚拟机管理软件增加物理磁盘大小" class="headerlink" title="虚拟机管理软件增加物理磁盘大小"></a>虚拟机管理软件增加物理磁盘大小</h4><p>我使用的是 Vmware Workstation pro，在编辑虚拟机设置里可以轻松增加磁盘大小（磁盘为单个文件，而不是分割文件，如果你的硬盘是分割的多个文件，参考另一篇博文 <a href>Vmware 分割磁盘如何扩容(尚未编写)</a></p><h4 id="查看新增加的磁盘位置"><a href="#查看新增加的磁盘位置" class="headerlink" title="查看新增加的磁盘位置"></a>查看新增加的磁盘位置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l</span><br><span class="line">## 在 fdisk 输出信息中，可以看到 Disk /dev/sda： 30 GB 类似的信息，证明磁盘增加成功，位置确认。</span><br></pre></td></tr></table></figure><h4 id="分区"><a href="#分区" class="headerlink" title="分区"></a>分区</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">## 以下命令为交互式命令</span><br><span class="line">fdisk /dev/sda</span><br><span class="line"></span><br><span class="line"># 输入 n 以创建新分区</span><br><span class="line">n</span><br><span class="line"># 输入 p 以设置为主分区</span><br><span class="line">p</span><br><span class="line"># 根据 fdisk -l 的信息，决定分区的编号，由于我的机器 fdisk -l 已经有 /dev/sda1 /dev/sda2 两个，所以此处输入 3</span><br><span class="line">3</span><br><span class="line"># 此处输入两次回车，以决定分区的开始和结束位置，默认使用剩余全部未分配空间</span><br><span class="line">First cylinder.... 回车</span><br><span class="line">Last cylinder.... 回车</span><br><span class="line"># 此处输入 t，并输入 3 以选择我们上面步骤刚刚创建的分区</span><br><span class="line">t</span><br><span class="line">3</span><br><span class="line"># 在 Hex code 的输入步骤，输入我们希望使用的 LVM 代码符号：8e</span><br><span class="line">8e</span><br><span class="line"># 最后，输入 w 以使上述所有更改生效</span><br><span class="line">w</span><br></pre></td></tr></table></figure><h4 id="查看分区结果"><a href="#查看分区结果" class="headerlink" title="查看分区结果"></a>查看分区结果</h4><p>在我的机器上，不需要重启已经可以使用 <code>fdisk -l</code> 查看到新创建的 /dev/sda3，但是推荐你在此处先重启一次，然后执行后续操作</p><h4 id="扩容"><a href="#扩容" class="headerlink" title="扩容"></a>扩容</h4><p>关键步骤来了。此处使用到了 pv，vg，lv 等名词，请自行搜索了解，如果不了解，也不影响操作执行。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 在 /dev/sda3 创建 pv</span></span><br><span class="line">pvcreate /dev/sda3 # 如果提示 Device /dev/sda3 not found, 请先重启。</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 vg 信息，获取到 vg 的 name，一般是你的机器名称，我的机器为 centos</span></span><br><span class="line">vgdisplay</span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加 pv 到 vg</span></span><br><span class="line">vgextend centos /dev/sda3 # 这里的 centos 是上一步查询出的 vg name</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 lv 的 path 信息</span></span><br><span class="line">lvdisplay # 此处我的 path 信息为 /dev/centos/root</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将新分区扩容到 lv </span></span><br><span class="line">lvextend /dev/centos/root /dev/sda3 # 此处 /dev/centos/root 为上一步查询出的 path</span><br><span class="line"><span class="meta">#</span><span class="bash"> 最后一步</span></span><br><span class="line">xfs_growfs /dev/centos/root # centos 7/RedHat 默认使用 xfs 文件系统，如果是 ext 文件系统，可以使用 resize2fs /dev/Mega/root 命令</span><br></pre></td></tr></table></figure></p><h4 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h4><p>使用 df -h 查看扩容的结果吧~</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;识别分区类型&quot;&gt;&lt;a href=&quot;#识别分区类型&quot; class=&quot;headerlink&quot; title=&quot;识别分区类型&quot;&gt;&lt;/a&gt;识别分区类型&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gut
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="centos7" scheme="https://snzhaoyua.github.io/tags/centos7/"/>
    
  </entry>
  
  <entry>
    <title>BTrace 使用教程</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181019%20BTrace%20%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181019 BTrace 使用教程/</id>
    <published>2019-09-22T04:56:05.256Z</published>
    <updated>2019-09-19T03:41:58.622Z</updated>
    
    <content type="html"><![CDATA[<div id="preamble"><div class="sectionbody"><div class="paragraph"><p><strong>BTrace</strong> 是 Java 的一个诊断工具，可以在不重启应用的情况下，对应用进行时间耗费、参数及结果跟踪、方法调用跟踪等分析。</p></div></div></div><div class="sect1"><h2 id="_btrace_术语">BTrace 术语</h2><div class="sectionbody"><div class="dlist quota"><dl><dt>Probe Point</dt><dd><p>位置</p></dd><dt>Trace Actions or Actions</dt><dd><p>追踪语句</p></dd><dt>Action Methods</dt><dd><p>追踪语句所在的静态方法</p></dd></dl></div></div></div><div class="sect1"><h2 id="_btrace_程序结构">BTrace 程序结构</h2><div class="sectionbody"><div class="paragraph"><p>一个 <strong>BTrace 程序</strong> 是一个 Java 类，包含数个由 <code>BTrace 注解</code> 注释的 <code>public static void</code> 方法。这些注解被用来指定被追踪程序的 <strong>Probe Point</strong>. <strong>Tracing Actions</strong> 在这些静态方法内定义。这些静态方法也即上文提到的 <strong>Action Methods</strong>。</p></div></div></div><div class="sect1"><h2 id="_btrace_的限制_i_class_fa_fa_exclamation_triangle_i">BTrace 的限制 <i class="fa fa-exclamation-triangle"></i></h2><div class="sectionbody"><div class="olist arabic"><ol class="arabic"><li><p>不能 创建对象，数组。</p></li><li><p>不能 抛出、捕获异常。</p></li><li><p>不能 调用任意实例或静态方法，只能调用 BTraceUtils 中的方法。</p></li><li><p>不能 修改目标程序的静态或实例变量，不过 BTrace 程序自己不做限制。</p></li><li><p>不能 有实例变量或方法，方法不能有返回值类型，BTrace 程序的所有方法必须是 public static 1. oid 的，所有的字段都必须是 static 的。</p></li><li><p>不能 有 outer, inner, nested 或 local 类。</p></li><li><p>不能 用 synchronized 关键字。</p></li><li><p>不能 有循环 (for, while, do..while)。</p></li><li><p>不能 继承任何类 (即父类只能是 java.lang.Object)。</p></li><li><p>不能 实现接口。</p></li><li><p>不能 包含 assert 语句.</p></li><li><p>不能 使用 class literals.</p></li></ol></div><div class="admonitionblock warning"><table><tr><td class="icon"><div class="title">Warning</div></td><td class="content"><div class="paragraph"><p>虽然不需要重启就可以使用 BTrace, 但是使用不当仍然会导致应用终止，比如目标程序可能会发生下面这种错误:</p></div></td></tr></table></div><div class="literalblock"><div class="content"><pre>Exception in thread "main" java.lang.NoSuchMethodError: com.foo.btraceDemo.Target.$btrace$com$foo$btraceDemo$Tracer$func(Ljava/lang/Object;IJII)V</pre></div></div></div></div><div class="sect1"><h2 id="_一个简单的_code_btrace_程序_code_演示">一个简单的 <code>BTrace 程序</code> 演示</h2><div class="sectionbody"><div class="listingblock"><div class="title">Tracer.java&#8201;&#8212;&#8201;BTrace 要执行的程序（脚本）</div><div class="content"><pre class="highlight"><code class="language-java" data-lang="java"><span class="comment">// 导入所有 BTrace 注解。</span><span class="keyword">import</span> com.sun.btrace.annotations.*;<span class="comment">// 导入 BTraceUtils 的静态方法。</span><span class="keyword">import</span> <span class="keyword">static</span> com.sun.btrace.BTraceUtils.*;<span class="comment">// @BTrace annotation tells that this is a BTrace program</span><span class="meta">@BTrace</span> (<span class="number">3</span>)<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;    <span class="comment">// @OnMethod 注解表明 Probe Point(位置)。</span>    <span class="comment">// 在这个例子中，我们对进入 Thread.start() 方法感兴趣。</span>    <span class="meta">@OnMethod</span>(        clazz=<span class="string">"java.lang.Thread"</span>,        method=<span class="string">"start"</span>    )    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;        <span class="comment">// println 是 BTraceUtils 的静态方法</span>        println(<span class="string">"about to start a thread!"</span>);        <span class="comment">// System.out.println("123"); (1)</span>        <span class="comment">// new Tracer(); : (2)</span>    &#125;&#125;</code></pre></div></div><div class="colist arabic"><ol><li><p>错误: Tracer.java:21:method calls are not allowed - only calls to BTraceUtils are allowed</p></li><li><p>错误: Tracer.java:22:object creation is not allowed</p></li><li><p>不要忘记 @BTrace 注解</p></li></ol></div><div class="listingblock"><div class="title">Target.java&#8201;&#8212;&#8201;模拟的线上应用</div><div class="content"><pre class="highlight"><code class="language-java" data-lang="java"><span class="keyword">import</span> java.util.concurrent.TimeUnit;<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Target</span> </span>&#123;    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;        <span class="keyword">try</span> &#123;            TimeUnit.SECONDS.sleep(<span class="number">15</span>);        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;            e.printStackTrace();        &#125;        System.out.println(<span class="string">"start main method..."</span>);        <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;            System.out.println(<span class="string">"starting new thread..."</span>);            <span class="keyword">new</span> Thread(() -&gt; &#123;                <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;                    <span class="keyword">try</span> &#123;                        TimeUnit.SECONDS.sleep(<span class="number">1</span>);                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;                        e.printStackTrace();                    &#125;                &#125;            &#125;).start();            TimeUnit.SECONDS.sleep(<span class="number">5</span>);        &#125;    &#125;&#125;</code></pre></div></div><div class="paragraph"><p>运行 Target.java 后，使用 jps -v 查看该程序 pid 号。</p></div><div class="listingblock"><div class="content"><pre>&gt; jps -v21952 Target -javaagent:D:\program\JetBrains\IntelliJ IDEA017.2.2\lib\idea_rt.jar=55132:D:\program\JetBrains\IntelliJIDEA 2017.2.2\bin -Dfile.encoding=UTF-8</pre></div></div><div class="paragraph"><p>使用 btrace 启用 Tracer.java。</p></div><div class="listingblock"><div class="content"><pre>## 首先切换到 Tracer.java 所在目录，然后执行&gt; btrace -v 21952 Tracer.java <b class="conum">(1)</b></pre></div></div><div class="colist arabic"><ol><li><p>-v 打印出 DEBUG 信息，无 -v 只输出你自己想要输出的信息</p></li></ol></div><div class="paragraph"><p>可以看到在 Target.java 和 BTrace 的窗口都输出了调试信息。在 Target 中一旦一个新线程被创建，BTrace 便可以打印出相关信息。</p></div></div></div><div class="sect1"><h2 id="_继续_btrace_注解">继续&#8201;&#8212;&#8201;BTrace 注解</h2><div class="sectionbody"><div class="paragraph"><p>假设我们想诊断这样一个 add 方法：</p></div><div class="listingblock"><div class="title">Target.java</div><div class="content"><pre class="highlight"><code class="language-java" data-lang="java"><span class="keyword">package</span> com.foo.btraceDemo;<span class="keyword">import</span> java.lang.management.ManagementFactory;<span class="keyword">import</span> java.util.concurrent.TimeUnit;<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Target</span> </span>&#123;    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String pid = ManagementFactory.getRuntimeMXBean().getName().split(<span class="string">"@"</span>)[<span class="number">0</span>];    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;        System.out.println(<span class="string">"pid: "</span> + pid);        <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;            System.out.println(<span class="string">"准备调用 add 方法..."</span>);            add(<span class="number">3</span>, <span class="number">5</span>);            System.out.println(<span class="string">"调用 add 方法结束..."</span>);        &#125;    &#125;    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;        TimeUnit.SECONDS.sleep(<span class="number">5</span>);        a = a + a;        System.out.println(<span class="string">"dododo"</span>);        a = a / <span class="number">2</span>;        <span class="keyword">return</span> a + b;    &#125;&#125;</code></pre></div></div></div></div><div class="sect1"><h2 id="_method_annotations_方法注释">Method Annotations 方法注释</h2><div class="sectionbody"><div class="olist arabic"><ol class="arabic"><li><p>@OnMethod</p><div class="listingblock"><div class="title">Tracer.java:func</div><div class="content"><pre class="highlight"><code class="language-java" data-lang="java"><span class="meta">@OnMethod</span>(clazz=<span class="string">"com.foo.btraceDemo.Target"</span>, method=<span class="string">"add"</span>,      location = <span class="meta">@Location</span>(Kind.RETURN))    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">(@Return <span class="keyword">int</span> result, @Duration <span class="keyword">long</span>     time, <span class="keyword">int</span> paramA, <span class="keyword">int</span> paramB)</span> </span>&#123;        println(<span class="string">"param:"</span> + paramA + <span class="string">", "</span> + paramB);        println(<span class="string">"result:"</span> + result);        println(<span class="string">"costs(ms):"</span> + time/<span class="number">1000</span>/<span class="number">1000</span>);    &#125;</code></pre></div></div><div class="paragraph"><p>输出结果</p></div><div class="listingblock"><div class="content"><pre>param:3, 5result:8costs(ms):5020param:3, 5result:8costs(ms):5013</pre></div></div><div class="olist loweralpha"><ol class="loweralpha" type="a"><li><p>如何通过 clazz/method 指定要诊断的方法</p><div class="olist lowerroman"><ol class="lowerroman" type="i"><li><p>全限定名</p><div class="literalblock"><div class="content"><pre>clazz="com.foo.btraceDemo.Target", method="add"</pre></div></div></li><li><p>正则表达式</p><div class="literalblock"><div class="content"><pre>clazz = "+java.sql.Statement", method = "/execute($|Update|Query|Batch)/"</pre></div></div></li><li><p>接口/父类，注解</p><div class="literalblock"><div class="content"><pre>clazz = "+java.sql.Statement" // 匹配所有实现该接口或父类的类clazz = "@org.springframework.stereotype.Controller" // 匹配所有 @Controller 注解的类</pre></div></div></li><li><p>构造函数</p><div class="literalblock"><div class="content"><pre>clazz="java.lang.Throwable",method="&lt;init&gt;",    location=@Location(Kind.RETURN) // 匹配任何异常被构造完成准备抛出</pre></div></div></li><li><p>静态内部类</p><div class="literalblock"><div class="content"><pre>clazz="com.foo.bar$YourInnerClass", method="mName")</pre></div></div></li><li><p>重载方法区别方法见下文</p></li></ol></div></li><li><p>如何通过 @Location 指定诊断方法的时机</p><div class="olist lowerroman"><ol class="lowerroman" type="i"><li><p>Kind.Entry Kind.Return</p><div class="ulist"><ul><li><p>Kind.Entry 方法进入时，为默认值。</p></li><li><p>Kind.Return 方法完成时, 指定此 Kind 可以使用 @Duration 获取方法耗时, @Return 获取方法返回结果</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java"><span class="meta">@OnMethod</span>(clazz=<span class="string">"com.foo.btraceDemo.Target"</span>, method=<span class="string">"add"</span>,    ocation = <span class="meta">@Location</span>(Kind.RETURN))<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">(@Return <span class="keyword">int</span> result, @Duration <span class="keyword">long</span> me,     <span class="keyword">int</span> paramA, <span class="keyword">int</span> paramB)</span> </span>&#123;          println(<span class="string">"param:"</span> + paramA + <span class="string">", "</span> + paramB);    println(<span class="string">"result:"</span> + result);    println(<span class="string">"costs(ms):"</span> + time/<span class="number">1000</span>/<span class="number">1000</span>);&#125;</code></pre></div></div></li></ul></div></li><li><p>Kind.Error, Kind.Throw和 Kind.Catch</p><div class="ulist"><ul><li><p>Kind.Error: 异常抛出方法之外</p></li><li><p>Kind.Throw: 异常被 throw 之处</p></li><li><p>Kind.Catch: 异常被 catch 之处</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java"><span class="meta">@OnMethod</span>(clazz = <span class="string">"java.net.ServerSocket"</span>, method = <span class="string">"bind"</span>, ocation = <span class="meta">@Location</span>(Kind.ERROR))<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">onBind</span><span class="params">(Throwable exception, @Duration <span class="keyword">long</span> uration)</span> <span class="comment">// 这种写法待验证</span></span></code></pre></div></div></li></ul></div></li><li><p>Kind.Call与Kind.Line</p><div class="literalblock"><div class="content"><pre>Kind.ENTRY （默认值）只关注目标方法（OnMethod 的clazz/method），Kind.CALL 关注目标方法中，调用的其它哪些类哪些方法（Location的class，method）。注意，一般网上的教程，在描述 Kind.ENTRY 和 Kind.CALL 时，会将 CALL 描述为“还关注目标方法中其它方法的调用”，但是经过验证，此处不是“还”的关系，而是过滤的逻辑。也就是说，指定了这里的 clazz 和 method（例如 MethodB），将忽略目标方法（MethodA）的其它逻辑的时间。示例代码如下：</pre></div></div><div class="listingblock"><div class="title">Target.java&#8201;&#8212;&#8201;add</div><div class="content"><pre class="highlight"><code class="language-java" data-lang="java"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;    TimeUnit.SECONDS.sleep(<span class="number">5</span>);    a = a + a;    System.out.println(<span class="string">"dododo"</span>);    a = a / <span class="number">2</span>;    <span class="keyword">return</span> a + b;&#125;</code></pre></div></div><div class="listingblock"><div class="title">Kind.ENTRY</div><div class="content"><pre class="highlight"><code class="language-java" data-lang="java"><span class="meta">@OnMethod</span>(clazz = <span class="string">"com.foo.btraceDemo.Target"</span>, method = <span class="string">"add"</span>, location = <span class="meta">@Location</span>(value = Kind.RETURN))<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">add1</span><span class="params">(@Duration <span class="keyword">long</span> time, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;    print(<span class="string">"add1 costs1(ns):"</span> + time);    totalTime += time;    counter ++;    println(<span class="string">", average(ns): "</span> + (totalTime/counter));&#125;</code></pre></div></div><div class="listingblock"><div class="content"><pre>add1 costs1(ns):5053722750, average(ns): 5053722750add1 costs1(ns):5050729632, average(ns): 5052226191add1 costs1(ns):5036155712, average(ns): 5046869364</pre></div></div><div class="listingblock"><div class="title">KIND.CALL 匹配 println</div><div class="content"><pre class="highlight"><code class="language-java" data-lang="java"><span class="meta">@OnMethod</span>(clazz = <span class="string">"com.foo.btraceDemo.Target"</span>, method = <span class="string">"add"</span>,            location = <span class="meta">@Location</span>(value = Kind.CALL, clazz = <span class="string">"java.io.PrintStream"</span>, method = <span class="string">"println"</span>, where = Where.AFTER))<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">add2</span><span class="params">(@Duration <span class="keyword">long</span> time)</span> </span>&#123;    print(<span class="string">"add2 costs(ns):"</span> + time);    totalTime += time;    counter ++;    println(<span class="string">", average(ns): "</span> + (totalTime/counter));&#125;</code></pre></div></div><div class="listingblock"><div class="content"><pre>add2 costs(ns):148064, average(ns): 148064add2 costs(ns):91911, average(ns): 119987add2 costs(ns):143314, average(ns): 127763</pre></div></div><div class="listingblock"><div class="title">KIND.CALL 匹配 *</div><div class="content"><pre class="highlight"><code class="language-java" data-lang="java"><span class="meta">@OnMethod</span>(clazz = <span class="string">"com.foo.btraceDemo.Target"</span>, method = <span class="string">"add"</span>,            location = <span class="meta">@Location</span>(value = Kind.CALL, clazz = <span class="string">"/.*/"</span>, method = <span class="string">"/.*/"</span>, where = Where.AFTER))<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">add3</span><span class="params">(@Duration <span class="keyword">long</span> time)</span> </span>&#123;    print(<span class="string">"add3 costs(ns):"</span> + time);    totalTime += time;    counter ++;    println(<span class="string">", average(ns): "</span> + (totalTime/counter));&#125;</code></pre></div></div><div class="listingblock"><div class="content"><pre>add3 costs(ns):5166920098, average(ns): 5166920098 <b class="conum">(1)</b>add3 costs(ns):81295, average(ns): 2583500696add3 costs(ns):5160914306, average(ns): 3442638566add3 costs(ns):68445, average(ns): 2581996036add3 costs(ns):5075955184, average(ns): 3080787865add3 costs(ns):67048, average(ns): 2567334396add3 costs(ns):5060307945, average(ns): 2923473474add3 costs(ns):115098, average(ns): 2558053677add3 costs(ns):5276136213, average(ns): 2860062848add3 costs(ns):93308, average(ns): 2574065894</pre></div></div><div class="colist arabic"><ol><li><p>注意这种写法打印的时间，你看出什么规律了吗?</p></li></ol></div></li></ol></div></li></ol></div></li><li><p>@OnTimer定时任务，单位 ms, 没有什么好解释的。</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java"><span class="meta">@OnTimer</span>(<span class="number">5000</span>)<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;    println(counter);&#125;</code></pre></div></div></li><li><p>@OnEvent</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-java" data-lang="java"><span class="meta">@OnEvent</span><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">defalutEvent</span><span class="params">()</span></span>&#123;    println(<span class="string">"default event sent..."</span>);&#125;<span class="meta">@OnEvent</span>(<span class="string">"speak"</span>)<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">namedEvent</span><span class="params">()</span></span>&#123;    println(<span class="string">"speak something..."</span>);&#125;</code></pre></div></div><div class="paragraph"><p>输出结果</p></div><div class="literalblock"><div class="content"><pre>Please enter your option:        1. exit        2. send an event        3. send a named event        4. flush console output&gt;3Please enter the event name: &gt;speakspeak something...&gt;1default event sent...</pre></div></div></li><li><p>@OnError</p><div class="dlist"><dl><dt class="hdlist1">Arguments Annotations 参数注释</dt><dd><p>jstat -J-Djstat.showUnsupported=true -name btrace.com.sun.btrace.samples.ThreadCounter.count &lt;pid&gt;</p></dd></dl></div></li></ol></div><div class="paragraph"><p>更多解释请参考 BTrace 本地安装路径下的帮助文档，或者 wiki</p></div><div class="ulist bibliography"><ul class="bibliography"><li><p><a href="https://github.com/btraceio/btrace/wiki/BTrace-Annotations" target="_blank" rel="noopener">wiki 页面</a></p></li><li><p><a href="https://blog.csdn.net/lirenzuo/article/details/76576064" target="_blank" rel="noopener">Btrace使用小结</a></p></li><li><p><a href="http://agapple.iteye.com/blog/962119?spm=a2c4e.11153940.blogcont7569.25.3d5955c8anNsnZ" target="_blank" rel="noopener">btrace记忆</a></p></li></ul></div></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;strong&gt;BTrace&lt;/strong&gt; 是 Java 的一个诊断工具，可以在不重启应用的情况下，对应用进行时间耗费、参数及结果
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Java" scheme="https://snzhaoyua.github.io/tags/Java/"/>
    
      <category term="btrace" scheme="https://snzhaoyua.github.io/tags/btrace/"/>
    
  </entry>
  
  <entry>
    <title>Scala sbt 使用自定义的 maven 仓库</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181013%20%5BScala%5D%20%5Bsbt%5D%20%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%20maven%20%E4%BB%93%E5%BA%93/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181013 [Scala] [sbt] 使用自定义的 maven 仓库/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.618Z</updated>
    
    <content type="html"><![CDATA[<h4 id="1-编辑或新建-HOME-sbt-repositories，添加如下"><a href="#1-编辑或新建-HOME-sbt-repositories，添加如下" class="headerlink" title="1.编辑或新建 ${HOME}/.sbt/repositories，添加如下"></a>1.编辑或新建 ${HOME}/.sbt/repositories，添加如下</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[repositories]</span><br><span class="line">local</span><br><span class="line">any-name-you-want: 你的仓库地址</span><br></pre></td></tr></table></figure><h4 id="2-编辑-sbt-安装目录-conf-sbtconfig-txt，如果你使用的-idea，在-settings-gt-SBT-gt-jvm-parameters-添加"><a href="#2-编辑-sbt-安装目录-conf-sbtconfig-txt，如果你使用的-idea，在-settings-gt-SBT-gt-jvm-parameters-添加" class="headerlink" title="2.编辑 ${sbt_安装目录}/conf/sbtconfig.txt，如果你使用的 idea，在 settings-&gt;SBT-&gt; jvm parameters 添加"></a>2.编辑 ${sbt_安装目录}/conf/sbtconfig.txt，如果你使用的 idea，在 settings-&gt;SBT-&gt; jvm parameters 添加</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Dsbt.override.build.repos=true ## 忽略工程自定义的 resolvers，采用全局配置</span><br></pre></td></tr></table></figure><blockquote><p>参考 <a href="https://www.scala-sbt.org/1.x/docs/Proxy-Repositories.html" target="_blank" rel="noopener">sbt 代理仓库 设置</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;1-编辑或新建-HOME-sbt-repositories，添加如下&quot;&gt;&lt;a href=&quot;#1-编辑或新建-HOME-sbt-repositories，添加如下&quot; class=&quot;headerlink&quot; title=&quot;1.编辑或新建 ${HOME}/.sbt/rep
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Scala" scheme="https://snzhaoyua.github.io/tags/Scala/"/>
    
  </entry>
  
  <entry>
    <title>CentOS 7 如何...</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181013%20CentOS%207%20%E5%A6%82%E4%BD%95.../"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181013 CentOS 7 如何.../</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.618Z</updated>
    
    <content type="html"><![CDATA[<h2 id="如何更改为静态-IP-地址"><a href="#如何更改为静态-IP-地址" class="headerlink" title="如何更改为静态 IP 地址"></a>如何更改为静态 IP 地址</h2><p>一. <code>vi /etc/sysconfig/network-scripts/ifcfg-&lt;你的网卡名，如果不知道，直接 tab 自动补全&gt;</code><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 更改并添加以下数行</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> BOOTPROTO=dfcp</span></span><br><span class="line">BOOTPROTO=static</span><br><span class="line"><span class="meta">#</span><span class="bash"> ONBOOT=no</span></span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=192.168.47.190 # IP 地址，先在虚拟机或路由里查看你的 IP 网段，然后在设置为你想要的值</span><br><span class="line">GATEWAY=192.168.47.2 # 网关信息，同上</span><br><span class="line">NETMASK=255.255.255.0 # 子网掩码信息，同上</span><br><span class="line">DNS1=8.8.8.8 # DNS 信息，同上</span><br></pre></td></tr></table></figure></p><p>二. <code>service network restart</code> 重启网络服务</p><h2 id="如何更改主机名"><a href="#如何更改主机名" class="headerlink" title="如何更改主机名"></a>如何更改主机名</h2><p><code>hostnamectl set-hostname &lt;你想要的主机名&gt;</code></p><h2 id="如何关闭防火墙和SELinux"><a href="#如何关闭防火墙和SELinux" class="headerlink" title="如何关闭防火墙和SELinux"></a>如何关闭防火墙和SELinux</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">systemctl disable firewalld.service</span><br><span class="line">systemctl stop firewalld.service</span><br><span class="line"></span><br><span class="line"># 编辑以下文件</span><br><span class="line">vi /etc/sysconfig/selinux</span><br><span class="line">SELINUX=disabled</span><br><span class="line"># 编辑完成后，执行</span><br><span class="line">setenforce 0</span><br><span class="line"># 重启后执行 getenforce 变成 disabled 说明更改永久生效</span><br></pre></td></tr></table></figure><h2 id="如何设置-NTP-时间同步"><a href="#如何设置-NTP-时间同步" class="headerlink" title="如何设置 NTP 时间同步"></a>如何设置 NTP 时间同步</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install -y ntp</span><br><span class="line">systemctl enable ntpd</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;如何更改为静态-IP-地址&quot;&gt;&lt;a href=&quot;#如何更改为静态-IP-地址&quot; class=&quot;headerlink&quot; title=&quot;如何更改为静态 IP 地址&quot;&gt;&lt;/a&gt;如何更改为静态 IP 地址&lt;/h2&gt;&lt;p&gt;一. &lt;code&gt;vi /etc/sysconfig
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="centos7" scheme="https://snzhaoyua.github.io/tags/centos7/"/>
    
  </entry>
  
  <entry>
    <title>npm, yarn 代理或国内镜像设置</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181013%20npm,%20yarn%20%E4%BB%A3%E7%90%86%E6%88%96%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E8%AE%BE%E7%BD%AE/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181013 npm, yarn 代理或国内镜像设置/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.618Z</updated>
    
    <content type="html"><![CDATA[<p>使用家目录下的默认rc文件配置，不使用 npm config set.. </p><p>npm 代理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vi ~/.npmrc</span><br><span class="line">## add these lines to .npmrc</span><br><span class="line">## privoxy and shadowsocks [如何配置 privoxy 详见另一篇博文]()</span><br><span class="line">proxy=http://localhost:8118</span><br><span class="line">https_proxy=https://localhost:8118</span><br><span class="line">strict-ssl=false</span><br></pre></td></tr></table></figure></p><p>npm 国内镜像-淘宝<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">registry=https://registry.npm.taobao.org</span><br><span class="line">## proxy=http://localhost:8118</span><br><span class="line">## https_proxy=https://localhost:8118</span><br><span class="line">## strict-ssl=false</span><br></pre></td></tr></table></figure></p><p>yarn 代理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vi ~/.yarnrc</span><br><span class="line">## add these lines to .yarnrc</span><br><span class="line">env:</span><br><span class="line">    proxy &apos;http://localhost:8118&apos;</span><br><span class="line">    https_proxy &apos;https://localhost:8118&apos;</span><br><span class="line">    strict-ssl false</span><br></pre></td></tr></table></figure></p><p>yarn 使用国内镜像<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn config set registry https://registry.npm.taobao.org</span><br><span class="line">yarn config list</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;使用家目录下的默认rc文件配置，不使用 npm config set.. &lt;/p&gt;
&lt;p&gt;npm 代理&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;li
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="npm" scheme="https://snzhaoyua.github.io/tags/npm/"/>
    
      <category term="yarn" scheme="https://snzhaoyua.github.io/tags/yarn/"/>
    
  </entry>
  
  <entry>
    <title>centos 7 安装 apache-ambari</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181013%20centos%207%20%E5%AE%89%E8%A3%85%20apache-ambari/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181013 centos 7 安装 apache-ambari/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.618Z</updated>
    
    <content type="html"><![CDATA[<h2 id="版本说明"><a href="#版本说明" class="headerlink" title="版本说明"></a>版本说明</h2><table><thead><tr><th>部件</th><th>版本号</th></tr></thead><tbody><tr><td>Ambari</td><td>2.6.2.2</td></tr><tr><td>CentOS</td><td>7</td></tr><tr><td>HDP</td><td>2.6</td></tr><tr><td>时间</td><td>20180814</td></tr></tbody></table><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>对于 Ambari 能做什么，对于搜索到此文的同学来说应该毋庸赘述。目前 Ambari 安装的官方手册主要是 <a href="https://cwiki.apache.org/confluence/display/AMBARI/Installation+Guide+for+Ambari+2.6.2" target="_blank" rel="noopener">Apache</a> 和 <a href="https://docs.hortonworks.com/HDPDocuments/Ambari-2.6.2.2/bk_ambari-installation/content/install-ambari-server.html" target="_blank" rel="noopener">Hortonworks</a>，我首先是参考 Apache 的说明，通过 maven 编译源码的方式，在 安装 linux-mint 的机器上尝试安装 <code>Ambari 2.7.0</code>，遇到过以下问题：</p><ol><li>由于系统不符合 Ambari 的要求，因此通过更改其中的 <code>ambari-commons/OSCheck.py:is_ubuntu_family()</code> 函数强制安装 server 和 agent.</li><li>由于采用的国内 maven 仓库，ambari web legacy 始终编译不过，通过更改其依赖编译通过.</li><li>maven compiler plugin 报错 json-simple 的相关依赖问题，最后删除该 legacy 模块.</li><li>其它 node, yarn, npm 的代理设置问题.<br>最终在安装 agent 的时候遇到 ssl 连接错误，时间已晚，选择放弃这种安装方式。转而使用文档支持较好的 CentOS 和 yum 仓库安装的方式。虽然如此，Hortonworks 的文档逻辑也稍显混乱，过于简单，本文对安装过程做详细记录，以备查询。<code>本文所有操作均使用 root 用户完成。</code></li></ol><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><h4 id="几台虚拟机"><a href="#几台虚拟机" class="headerlink" title="几台虚拟机"></a>几台虚拟机</h4><p>我使用的是 Vmware WorkStation，CentOS 7 下载路径为  <a href="http://isoredirect.centos.org/centos/7/isos/x86_64/CentOS-7-x86_64-DVD-1804.iso" target="_blank" rel="noopener">点我</a>，安装步骤略过，建议安装 4 台机器(网络方式选择NAT模式)，其中安装 Ambari 服务器的机器硬盘大小不得小于 30 GB，如果不小心硬盘大小分配过小，参见另一篇博文<a href="/2018/10/13/如何对 centos 7 分区进行扩容/">如何对 centos 7 分区进行扩容</a>。其余 3 台机器作为集群机器以备后续使用。</p><h6 id="静态-IP-，hostname-设置，关闭防火墙，设置NTP时间同步服务"><a href="#静态-IP-，hostname-设置，关闭防火墙，设置NTP时间同步服务" class="headerlink" title="静态 IP ，hostname 设置，关闭防火墙，设置NTP时间同步服务"></a>静态 IP ，hostname 设置，关闭防火墙，设置NTP时间同步服务</h6><p>参见另一篇博文 <a href="/2018/10/13/CentOS 7 如何...">CentOS 7 如何…</a></p><h6 id="设置-hosts-文件以便识别自定义的-hostname"><a href="#设置-hosts-文件以便识别自定义的-hostname" class="headerlink" title="设置 hosts 文件以便识别自定义的 hostname"></a>设置 hosts 文件以便识别自定义的 hostname</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> vi /etc/hosts</span></span><br><span class="line">x.x.x.x linux-1</span><br><span class="line">x.x.x.x linux-2</span><br><span class="line">x.x.x.x linux-3</span><br><span class="line">x.x.x.x linux-4</span><br></pre></td></tr></table></figure><p>然后 <code>scp /etc/hosts 其它机器主机名:/etc/hosts</code> 到其它机器。</p><h6 id="设置无密码访问-ssh"><a href="#设置无密码访问-ssh" class="headerlink" title="设置无密码访问 ssh"></a>设置无密码访问 ssh</h6><p>参见另一篇博文 <a href="/2018/10/13/免密码 ssh 到其它机器">免密码 ssh 到其它机器</a></p><h6 id="umask-文件默认权限设置"><a href="#umask-文件默认权限设置" class="headerlink" title="umask 文件默认权限设置"></a>umask 文件默认权限设置</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">## 默认权限更改为 755</span><br><span class="line">umask 0022</span><br></pre></td></tr></table></figure><h6 id="关闭-ssl-检查（注意，后面安装-HDP-还会有一次-openssl-相关的报错）"><a href="#关闭-ssl-检查（注意，后面安装-HDP-还会有一次-openssl-相关的报错）" class="headerlink" title="关闭 ssl 检查（注意，后面安装 HDP 还会有一次 openssl 相关的报错）"></a>关闭 ssl 检查（注意，后面安装 HDP 还会有一次 openssl 相关的报错）</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/python/cert-verification.cfg </span><br><span class="line"># verify=platformxxx 改为</span><br><span class="line">verify=disable</span><br></pre></td></tr></table></figure><h6 id="安装-httpd-服务器作为后续离线安装包服务器"><a href="#安装-httpd-服务器作为后续离线安装包服务器" class="headerlink" title="安装 httpd 服务器作为后续离线安装包服务器"></a>安装 httpd 服务器作为后续离线安装包服务器</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install httpd</span><br><span class="line">chkconfig httpd on</span><br><span class="line">service httpd start</span><br></pre></td></tr></table></figure><h6 id="关于-JDK"><a href="#关于-JDK" class="headerlink" title="关于 JDK"></a>关于 JDK</h6><p>如果环境中没有 JDK，ambari 在安装设置阶段可以自动在线安装 JDK。但是如果已经安装了 JDK（要求1.8 版本），设置阶段指定 JDK_HOME 所在的路径即可，参见后续 ambari-server setup 阶段。</p><h6 id="关于-python-和其它"><a href="#关于-python-和其它" class="headerlink" title="关于 python 和其它"></a>关于 python 和其它</h6><p>如果你使用的是我上面提供的官方 CentOS 7 镜像，python 的版本应该为 2.7，不需要任何修改。<br>后续安装需要使用 wget 工具，请使用 <code>yum install wget</code> 安装。<br>后续安装需要使用其它软件源管理工具，请使用 <code>yum install yum-utils createrepo yum-plugin-priorities -y</code> 安装。执行以下修改，以关闭 gpg 校验（否则后面安装会报错）。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/yum/pluginconf.d/priorities.conf</span><br><span class="line">## 添加或更改为以下内容</span><br><span class="line">gpgcheck = 0</span><br></pre></td></tr></table></figure></p><h2 id="安装包获取"><a href="#安装包获取" class="headerlink" title="安装包获取"></a>安装包获取</h2><p>CentOS 7 采用 yum 安装 ambari-server，该软件可以通过<code>在线</code>和<code>离线</code>两种方式下载到本地，出于国情，很明显我们应该选择离线安装的方式。</p><h6 id="步骤1-下载离线包到本地"><a href="#步骤1-下载离线包到本地" class="headerlink" title="步骤1 下载离线包到本地"></a>步骤1 下载离线包到本地</h6><p>由于我们使用的是 Ambari 2.6.2.2 ，配套的 HDP 版本为 2.[4|5|6]，本文选用 HDP 2.6，附上需要下载的所有包路径(<code>以下 tar 包都需要下载</code>)：</p><table><thead><tr><th>包名</th><th>路径</th></tr></thead><tbody><tr><td>ambari</td><td><a href="http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.6.2.2/ambari-2.6.2.2-centos7.tar.gz" target="_blank" rel="noopener">点我</a></td></tr><tr><td>HDP</td><td><a href="http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.5.0/HDP-2.6.5.0-centos7-rpm.tar.gz" target="_blank" rel="noopener">点我</a></td></tr><tr><td>HDP-UTILS</td><td><a href="http://public-repo-1.hortonworks.com/HDP-UTILS-1.1.0.22/repos/centos7/HDP-UTILS-1.1.0.22-centos7.tar.gz" target="_blank" rel="noopener">点我</a></td></tr></tbody></table><h6 id="步骤2-上传到需要安装-Ambari-的机器上，解压到-httpd-的服务器目录中"><a href="#步骤2-上传到需要安装-Ambari-的机器上，解压到-httpd-的服务器目录中" class="headerlink" title="步骤2 上传到需要安装 Ambari 的机器上，解压到 httpd 的服务器目录中"></a>步骤2 上传到需要安装 Ambari 的机器上，解压到 httpd 的服务器目录中</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /var/www/html</span><br><span class="line">mkdir hdp ambari</span><br><span class="line">tar zxvf &lt;你上传的路径&gt;/ambari-2.6.2.2-centos7.tar.gz -C /var/www/html/ambari</span><br><span class="line">tar zxvf &lt;你上传的路径&gt;/HDP-2.6.5.0-centos7-rpm.tar.gz -C /var/www/html/hdp</span><br><span class="line">tar zxvf &lt;你上传的路径&gt;/HDP-UTILS-1.1.0.22-centos7.tar.gz -C /var/www/html/hdp</span><br></pre></td></tr></table></figure><h6 id="步骤3-使用-createrepo-工具配置生成源描述文件-可省略，会影响后续-repo-文件的路径配置"><a href="#步骤3-使用-createrepo-工具配置生成源描述文件-可省略，会影响后续-repo-文件的路径配置" class="headerlink" title="步骤3 使用 createrepo 工具配置生成源描述文件(可省略，会影响后续 repo 文件的路径配置)"></a>步骤3 使用 createrepo 工具配置生成源描述文件(可省略，会影响后续 repo 文件的路径配置)</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /var/www/html/ambari</span><br><span class="line">createrepo ./</span><br><span class="line">cd /var/www/html/hdp</span><br><span class="line">createrepo ./</span><br></pre></td></tr></table></figure><h6 id="步骤4-下载-HDP-和-Ambari-的-yum-repo-文件"><a href="#步骤4-下载-HDP-和-Ambari-的-yum-repo-文件" class="headerlink" title="步骤4 下载 HDP 和 Ambari 的 yum repo 文件"></a>步骤4 下载 HDP 和 Ambari 的 yum repo 文件</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/yum.repos.d</span><br><span class="line">wget -nv http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.5.0/hdp.repo</span><br><span class="line">wget -nv http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.6.2.2/ambari.repo</span><br></pre></td></tr></table></figure><h6 id="步骤5-配置-yum-repo-文件指向本地的软件源"><a href="#步骤5-配置-yum-repo-文件指向本地的软件源" class="headerlink" title="步骤5 配置 yum repo 文件指向本地的软件源"></a>步骤5 配置 yum repo 文件指向本地的软件源</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/yum.repos.d/ambari.repo</span><br><span class="line">## 更改 baseurl 和 gpgcheck 两项</span><br><span class="line">baseurl=http:///&lt;你的主机名&gt;/ambari</span><br><span class="line">gpgcheck=0</span><br><span class="line"></span><br><span class="line">vi /etc/yum.repos.d/hdp.repo ## 根据步骤3，HDP 和 HDP-UTILS 可以使用同一个 baseurl</span><br><span class="line">## 更改 baseurl 和 gpgcheck 两项</span><br><span class="line">baseurl=http:///&lt;你的主机名&gt;/hdp</span><br><span class="line">gpgcheck=0</span><br></pre></td></tr></table></figure><h6 id="步骤6-刷新软件源"><a href="#步骤6-刷新软件源" class="headerlink" title="步骤6 刷新软件源"></a>步骤6 刷新软件源</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br><span class="line">## 如果此过程出现 404 错误，检查 httpd 服务是否正常，或者步骤3</span><br></pre></td></tr></table></figure><h2 id="安装、配置、启动与登录"><a href="#安装、配置、启动与登录" class="headerlink" title="安装、配置、启动与登录"></a>安装、配置、启动与登录</h2><p>此过程较为简单。</p><h6 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install ambari-server</span><br></pre></td></tr></table></figure><h6 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ambari-server setup</span><br><span class="line">其中可以配置是否创建用户、JDK、Ambari 自用元数据库（默认 Postgre）等，可以选择一路回车。</span><br></pre></td></tr></table></figure><h6 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service ambari-server start</span><br></pre></td></tr></table></figure><h6 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h6><p>访问 <code>http://&lt;你的主机 IP 地址&gt;:8080/</code>，使用默认的 <code>admin/admin</code> 账户登录即可。</p><p>使用 Ambari 安装 hadoop 集群可以参考另外一篇博文<a href="/2018/10/13/使用 Ambari 安装 HDP 集群">使用 Ambari 安装 hadoop 集群</a>。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;版本说明&quot;&gt;&lt;a href=&quot;#版本说明&quot; class=&quot;headerlink&quot; title=&quot;版本说明&quot;&gt;&lt;/a&gt;版本说明&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;部件&lt;/th&gt;
&lt;th&gt;版本号&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbo
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="centos7" scheme="https://snzhaoyua.github.io/tags/centos7/"/>
    
      <category term="ambari" scheme="https://snzhaoyua.github.io/tags/ambari/"/>
    
      <category term="BigData" scheme="https://snzhaoyua.github.io/tags/BigData/"/>
    
  </entry>
  
  <entry>
    <title>vmware clone 机器地址重复_ubuntu18.04地址配置</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181013%20vmware%20clone%20%E6%9C%BA%E5%99%A8%E5%9C%B0%E5%9D%80%E9%87%8D%E5%A4%8D_ubuntu18.04%E5%9C%B0%E5%9D%80%E9%85%8D%E7%BD%AE/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181013 vmware clone 机器地址重复_ubuntu18.04地址配置/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.618Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>&nbsp;&nbsp;&nbsp;&nbsp;在使用 VMware Workstation 克隆 Ubuntu Server 18.04 版本后，发现克隆前后的机器 ip地址 重复，且无论如何更改虚拟网络设置（编辑-虚拟网络编辑器）都无效。由于 Ubuntu 18.04 采用 netplan (/etc/netplan) 而不是先前版本的 /etc/network/interfaces 管理网卡设置，因此通过如下方法，将机器 ip 地址更改为静态获取，可以解决此问题。</p></div><div class="listingblock"><div class="title">1. vi /etc/netplan/50-cloud-init.yaml (此文件名可能会变化)</div><div class="content"><pre class="highlight"><code class="language-yaml" data-lang="yaml"><span class="attr">network:</span><span class="attr">    ethernets:</span><span class="attr">          ens33:</span><span class="attr">                  dhcp4:</span> <span class="literal">no</span><span class="attr">                  dhcp6:</span> <span class="literal">no</span><span class="attr">                  addresses:</span> <span class="string">[192.168.44.129/24,]</span><span class="attr">                  gateway4:</span> <span class="number">192.168</span><span class="number">.44</span><span class="number">.1</span><span class="attr">                  nameservers:</span><span class="attr">                          addresses:</span> <span class="string">[8.8.8.8,</span> <span class="number">8.8</span><span class="number">.4</span><span class="number">.4</span><span class="string">]</span></code></pre></div></div><div class="listingblock"><div class="title">2. 更改后，执行</div><div class="content"><pre class="highlight"><code class="language-shell" data-lang="shell"><span class="meta">&gt;</span><span class="bash">netplan apply</span><span class="meta">&gt;</span><span class="bash">reboot</span></code></pre></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;在使用 VMware Workstation 克隆 Ubuntu Server 18.04 版本后，发现克隆前后的机器 ip地址 重复，且无论如何更改虚拟网络设置（编辑-虚拟网络
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Ubuntu 18.04" scheme="https://snzhaoyua.github.io/tags/Ubuntu-18-04/"/>
    
      <category term="Linux" scheme="https://snzhaoyua.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>ubuntu 18.04 更改 hostname</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181013%20ubuntu%2018.04%20%E6%9B%B4%E6%94%B9%20hostname/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181013 ubuntu 18.04 更改 hostname/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.618Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/cloud/cloud.cfg</span><br><span class="line"><span class="meta">#</span><span class="bash">preserve_hostname: <span class="literal">false</span>  ---&gt; 改成 <span class="literal">true</span></span></span><br><span class="line">vi /etc/hostname</span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Ubuntu 18.04" scheme="https://snzhaoyua.github.io/tags/Ubuntu-18-04/"/>
    
      <category term="Linux" scheme="https://snzhaoyua.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>hadoop 2.9.1 学习笔记</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181013%20hadoop%202.9.1%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181013 hadoop 2.9.1 学习笔记/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.618Z</updated>
    
    <content type="html"><![CDATA[<h1 id="hadoop-学习笔记"><a href="#hadoop-学习笔记" class="headerlink" title="hadoop 学习笔记"></a>hadoop 学习笔记</h1><h1 id="HDFS读写流程"><a href="#HDFS读写流程" class="headerlink" title="HDFS读写流程"></a>HDFS读写流程</h1><h1 id="HDFS文件权限"><a href="#HDFS文件权限" class="headerlink" title="HDFS文件权限"></a>HDFS文件权限</h1><h1 id="安全模式"><a href="#安全模式" class="headerlink" title="安全模式"></a>安全模式</h1><h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><p>JDK 版本应该使用 1.8，JDK 10 遇到启动过程中 warning 并且 datanode 无法启动的问题。</p><h1 id="集群安装"><a href="#集群安装" class="headerlink" title="集群安装"></a>集群安装</h1><h2 id="最小配置文件（hadoop-2-9-1）"><a href="#最小配置文件（hadoop-2-9-1）" class="headerlink" title="最小配置文件（hadoop 2.9.1）"></a>最小配置文件（hadoop 2.9.1）</h2><p>core-site.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://linux-1:8020/<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>NameNode URI<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>io.file.buffer.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>131072<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>Buffer size<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>hdfs-site.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.secondary.http.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>linux-2:50090<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.http.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>linux-1:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hdfs/namenode<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>NameNode directory for namespace and transaction logs storage.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hdfs/namenode<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>DFS name node should store the transaction (edits) file.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hdfs/datanode<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>DataNode directory<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.checkpoint.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hdfs/secondarynamenode<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>Secondary Namenode directory<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hdfs/namenode<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>DFS name node should store the transaction (edits) file.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hdfs/datanode<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>DataNode directory<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.checkpoint.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hdfs/secondarynamenode<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>Secondary Namenode directory<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.checkpoint.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hdfs/secondarynamenode<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>DFS secondary name node should store the temporary edits to merge.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.checkpoint.period<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>7200<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>The number of seconds between two periodic checkpoints.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.checkpoint.txns<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>1000000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>SecondaryNode or CheckpointNode will create a checkpoint of namespace every 1000000 transactions<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.permissions<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.use.datanode.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.datanode.registration.ip-hostname-check<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>mapred-site.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>MapReduce framework name<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>linux-1:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>Default port is 10020.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>linux-1:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>Default port is 19888.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.intermediate-done-dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>/mr-history/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>Directory where history files are written by MapReduce jobs.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.done-dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>/mr-history/done<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">description</span>&gt;</span>Directory where history files are managed by the MR JobHistory Server.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>yarn-site.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Site specific YARN configuration properties --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span>Yarn Node Manager Aux Service<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services.mapreduce.shuffle.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.mapred.ShuffleHandler<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.local-dirs<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/yarn/local<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.log-dirs<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/yarn/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>hadoop-env.sh<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#update this line</span></span></span><br><span class="line">export JAVA_HOME=/opt/jdk1.8.0_181</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#add this to last</span></span></span><br><span class="line">export HADOOP_HOME=/opt/hadoop-2.9.1</span><br><span class="line">export HADOOP_CONF_DIR=/opt/hadoop-2.9.1/etc/hadoop</span><br><span class="line">export HADOOP_LOG_DIR=$&#123;HADOOP_HOME&#125;/logs</span><br></pre></td></tr></table></figure></p><p>/etc/profile<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">export HADOOP_INSTALL=/opt/hadoop-2.9.1  </span><br><span class="line">export PATH=$PATH:$HADOOP_INSTALL/bin  </span><br><span class="line">export PATH=$PATH:$HADOOP_INSTALL/sbin  </span><br><span class="line">export HADOOP_MAPRED_HOME=$HADOOP_INSTALL  </span><br><span class="line">export HADOOP_COMMON_HOME=$HADOOP_INSTALL  </span><br><span class="line">export HADOOP_HDFS_HOME=$HADOOP_INSTALL  </span><br><span class="line">export YARN_HOME=$HADOOP_INSTALL</span><br><span class="line">export HADOOP_CONF_DIR=$HADOOP_INSTALL/etc/hadoop</span><br><span class="line">export HADOOP_PREFIX=$HADOOP_INSTALL</span><br></pre></td></tr></table></figure></p><h1 id="启动命令"><a href="#启动命令" class="headerlink" title="启动命令"></a>启动命令</h1><p>start-all.sh (废弃)</p><h2 id="NameNode"><a href="#NameNode" class="headerlink" title="NameNode"></a>NameNode</h2><p>start-dfs.sh<br><a href="http://192.168.44.128:50070/dfshealth.html#tab-overview" target="_blank" rel="noopener">http://192.168.44.128:50070/dfshealth.html#tab-overview</a></p><h2 id="ResourceManager"><a href="#ResourceManager" class="headerlink" title="ResourceManager"></a>ResourceManager</h2><p>start-yarn.sh<br><a href="http://192.168.44.128:8088/cluster" target="_blank" rel="noopener">http://192.168.44.128:8088/cluster</a></p><h2 id="JobHistoryServer"><a href="#JobHistoryServer" class="headerlink" title="JobHistoryServer"></a>JobHistoryServer</h2><p><code>mr-jobhistory-daemon.sh --config /opt/hadoop-2.9.1/etc/hadoop start historyserver</code><br><a href="http://192.168.44.128:19888/jobhistory" target="_blank" rel="noopener">http://192.168.44.128:19888/jobhistory</a></p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><blockquote><p><a href="http://gaurav3ansal.blogspot.com/2018/06/install-hadoop-291-pseudo-distributed.html" target="_blank" rel="noopener">http://gaurav3ansal.blogspot.com/2018/06/install-hadoop-291-pseudo-distributed.html</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;hadoop-学习笔记&quot;&gt;&lt;a href=&quot;#hadoop-学习笔记&quot; class=&quot;headerlink&quot; title=&quot;hadoop 学习笔记&quot;&gt;&lt;/a&gt;hadoop 学习笔记&lt;/h1&gt;&lt;h1 id=&quot;HDFS读写流程&quot;&gt;&lt;a href=&quot;#HDFS读写流程&quot;
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="BigData" scheme="https://snzhaoyua.github.io/tags/BigData/"/>
    
      <category term="Hadoop" scheme="https://snzhaoyua.github.io/tags/Hadoop/"/>
    
  </entry>
  
  <entry>
    <title>免密码 ssh 到其它机器</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181013%20%E5%85%8D%E5%AF%86%E7%A0%81%20ssh%20%E5%88%B0%E5%85%B6%E5%AE%83%E6%9C%BA%E5%99%A8/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181013 免密码 ssh 到其它机器/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.622Z</updated>
    
    <content type="html"><![CDATA[<p>背景：在配置 hadoop 的时候这样设置会比较方便。<br>目标：A 机器上输入 ssh root@B 可以直接访问，不需要输入密码</p><p>步骤：</p><ol><li><p>首先在 A 机器上生成密钥对，一路回车</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure></li><li><p>在 A 机器上输入，输入 B 机器的密码一次即可</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id -i ~/.ssh/id_rsa.pub root@B</span><br></pre></td></tr></table></figure></li></ol><p>所以同样的操作，B机器上可能还要再操作一遍，如果机器多了，也是很烦，因此，更懒人的做法是：</p><ol><li>准备 xshell 5</li><li>打开多个机器的 ssh 会话窗口</li><li>配置好各个机器的 hostname</li><li>在 xshell 底部，“发送命令到所有窗口”这一行，依次输入 <code>ssh-copy-id -i ~/.ssh/id_rsa.pub root@&lt;主机名&gt;</code> 即可。 </li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;背景：在配置 hadoop 的时候这样设置会比较方便。&lt;br&gt;目标：A 机器上输入 ssh root@B 可以直接访问，不需要输入密码&lt;/p&gt;
&lt;p&gt;步骤：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;首先在 A 机器上生成密钥对，一路回车&lt;/p&gt;
 &lt;figure class=&quot;hi
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Linux" scheme="https://snzhaoyua.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>更换 python pip 软件源</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181013%20%E6%9B%B4%E6%8D%A2%20Python%20pip%20%E8%BD%AF%E4%BB%B6%E6%BA%90/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181013 更换 Python pip 软件源/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.622Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/.pip</span><br><span class="line">cd ~/.pip</span><br><span class="line">touch pip.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># add these lines</span></span></span><br><span class="line">[global]  </span><br><span class="line">timeout = 6000  </span><br><span class="line">index-url = https://pypi.doubanio.com/simple/  </span><br><span class="line">[install]  </span><br><span class="line">use-mirrors = true  </span><br><span class="line">mirrors = https://pypi.doubanio.com/simple/</span><br></pre></td></tr></table></figure><p><code>pip install --upgrade pip</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Python" scheme="https://snzhaoyua.github.io/tags/Python/"/>
    
      <category term="pip" scheme="https://snzhaoyua.github.io/tags/pip/"/>
    
  </entry>
  
  <entry>
    <title>centos 7 安装 apache-ambari</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/20181013%20centos%207%20%E5%AE%89%E8%A3%85%20apache-ambari/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/20181013 centos 7 安装 apache-ambari/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T08:06:41.353Z</updated>
    
    <content type="html"><![CDATA[<h2 id="版本说明"><a href="#版本说明" class="headerlink" title="版本说明"></a>版本说明</h2><table><thead><tr><th>部件</th><th>版本号</th></tr></thead><tbody><tr><td>Ambari</td><td>2.6.2.2</td></tr><tr><td>CentOS</td><td>7</td></tr><tr><td>HDP</td><td>2.6</td></tr><tr><td>时间</td><td>20180814</td></tr></tbody></table><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>对于 Ambari 能做什么，对于搜索到此文的同学来说应该毋庸赘述。目前 Ambari 安装的官方手册主要是 <a href="https://cwiki.apache.org/confluence/display/AMBARI/Installation+Guide+for+Ambari+2.6.2" target="_blank" rel="noopener">Apache</a> 和 <a href="https://docs.hortonworks.com/HDPDocuments/Ambari-2.6.2.2/bk_ambari-installation/content/install-ambari-server.html" target="_blank" rel="noopener">Hortonworks</a>，我首先是参考 Apache 的说明，通过 maven 编译源码的方式，在 安装 linux-mint 的机器上尝试安装 <code>Ambari 2.7.0</code>，遇到过以下问题：</p><ol><li>由于系统不符合 Ambari 的要求，因此通过更改其中的 <code>ambari-commons/OSCheck.py:is_ubuntu_family()</code> 函数强制安装 server 和 agent.</li><li>由于采用的国内 maven 仓库，ambari web legacy 始终编译不过，通过更改其依赖编译通过.</li><li>maven compiler plugin 报错 json-simple 的相关依赖问题，最后删除该 legacy 模块.</li><li>其它 node, yarn, npm 的代理设置问题.<br>最终在安装 agent 的时候遇到 ssl 连接错误，时间已晚，选择放弃这种安装方式。转而使用文档支持较好的 CentOS 和 yum 仓库安装的方式。虽然如此，Hortonworks 的文档逻辑也稍显混乱，过于简单，本文对安装过程做详细记录，以备查询。<code>本文所有操作均使用 root 用户完成。</code></li></ol><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><h4 id="几台虚拟机"><a href="#几台虚拟机" class="headerlink" title="几台虚拟机"></a>几台虚拟机</h4><p>我使用的是 Vmware WorkStation，CentOS 7 下载路径为  <a href="http://isoredirect.centos.org/centos/7/isos/x86_64/CentOS-7-x86_64-DVD-1804.iso" target="_blank" rel="noopener">点我</a>，安装步骤略过，建议安装 4 台机器(网络方式选择NAT模式)，其中安装 Ambari 服务器的机器硬盘大小不得小于 30 GB，如果不小心硬盘大小分配过小，参见另一篇博文<a href="/2018/10/13/如何对 centos 7 分区进行扩容/">如何对 centos 7 分区进行扩容</a>。其余 3 台机器作为集群机器以备后续使用。</p><h6 id="静态-IP-，hostname-设置，关闭防火墙，设置NTP时间同步服务"><a href="#静态-IP-，hostname-设置，关闭防火墙，设置NTP时间同步服务" class="headerlink" title="静态 IP ，hostname 设置，关闭防火墙，设置NTP时间同步服务"></a>静态 IP ，hostname 设置，关闭防火墙，设置NTP时间同步服务</h6><p>参见另一篇博文 <a href="/2018/10/13/CentOS 7 如何...">CentOS 7 如何…</a></p><h6 id="设置-hosts-文件以便识别自定义的-hostname"><a href="#设置-hosts-文件以便识别自定义的-hostname" class="headerlink" title="设置 hosts 文件以便识别自定义的 hostname"></a>设置 hosts 文件以便识别自定义的 hostname</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> vi /etc/hosts</span><br><span class="line">x.x.x.x linux-1</span><br><span class="line">x.x.x.x linux-2</span><br><span class="line">x.x.x.x linux-3</span><br><span class="line">x.x.x.x linux-4</span><br></pre></td></tr></table></figure><p>然后 <code>scp /etc/hosts 其它机器主机名:/etc/hosts</code> 到其它机器。</p><h6 id="设置无密码访问-ssh"><a href="#设置无密码访问-ssh" class="headerlink" title="设置无密码访问 ssh"></a>设置无密码访问 ssh</h6><p>参见另一篇博文 <a href="/2018/10/13/免密码 ssh 到其它机器">免密码 ssh 到其它机器</a></p><h6 id="umask-文件默认权限设置"><a href="#umask-文件默认权限设置" class="headerlink" title="umask 文件默认权限设置"></a>umask 文件默认权限设置</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">## 默认权限更改为 755</span><br><span class="line">umask 0022</span><br></pre></td></tr></table></figure><h6 id="关闭-ssl-检查（注意，后面安装-HDP-还会有一次-openssl-相关的报错）"><a href="#关闭-ssl-检查（注意，后面安装-HDP-还会有一次-openssl-相关的报错）" class="headerlink" title="关闭 ssl 检查（注意，后面安装 HDP 还会有一次 openssl 相关的报错）"></a>关闭 ssl 检查（注意，后面安装 HDP 还会有一次 openssl 相关的报错）</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/python/cert-verification.cfg </span><br><span class="line"># verify=platformxxx 改为</span><br><span class="line">verify=disable</span><br></pre></td></tr></table></figure><h6 id="安装-httpd-服务器作为后续离线安装包服务器"><a href="#安装-httpd-服务器作为后续离线安装包服务器" class="headerlink" title="安装 httpd 服务器作为后续离线安装包服务器"></a>安装 httpd 服务器作为后续离线安装包服务器</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install httpd</span><br><span class="line">chkconfig httpd on</span><br><span class="line">service httpd start</span><br></pre></td></tr></table></figure><h6 id="关于-JDK"><a href="#关于-JDK" class="headerlink" title="关于 JDK"></a>关于 JDK</h6><p>如果环境中没有 JDK，ambari 在安装设置阶段可以自动在线安装 JDK。但是如果已经安装了 JDK（要求1.8 版本），设置阶段指定 JDK_HOME 所在的路径即可，参见后续 ambari-server setup 阶段。</p><h6 id="关于-python-和其它"><a href="#关于-python-和其它" class="headerlink" title="关于 python 和其它"></a>关于 python 和其它</h6><p>如果你使用的是我上面提供的官方 CentOS 7 镜像，python 的版本应该为 2.7，不需要任何修改。<br>后续安装需要使用 wget 工具，请使用 <code>yum install wget</code> 安装。<br>后续安装需要使用其它软件源管理工具，请使用 <code>yum install yum-utils createrepo yum-plugin-priorities -y</code> 安装。执行以下修改，以关闭 gpg 校验（否则后面安装会报错）。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/yum/pluginconf.d/priorities.conf</span><br><span class="line">## 添加或更改为以下内容</span><br><span class="line">gpgcheck = 0</span><br></pre></td></tr></table></figure></p><h2 id="安装包获取"><a href="#安装包获取" class="headerlink" title="安装包获取"></a>安装包获取</h2><p>CentOS 7 采用 yum 安装 ambari-server，该软件可以通过<code>在线</code>和<code>离线</code>两种方式下载到本地，出于国情，很明显我们应该选择离线安装的方式。</p><h6 id="步骤1-下载离线包到本地"><a href="#步骤1-下载离线包到本地" class="headerlink" title="步骤1 下载离线包到本地"></a>步骤1 下载离线包到本地</h6><p>由于我们使用的是 Ambari 2.6.2.2 ，配套的 HDP 版本为 2.[4|5|6]，本文选用 HDP 2.6，附上需要下载的所有包路径(<code>以下 tar 包都需要下载</code>)：</p><table><thead><tr><th>包名</th><th>路径</th></tr></thead><tbody><tr><td>ambari</td><td><a href="http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.6.2.2/ambari-2.6.2.2-centos7.tar.gz" target="_blank" rel="noopener">点我</a></td></tr><tr><td>HDP</td><td><a href="http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.5.0/HDP-2.6.5.0-centos7-rpm.tar.gz" target="_blank" rel="noopener">点我</a></td></tr><tr><td>HDP-UTILS</td><td><a href="http://public-repo-1.hortonworks.com/HDP-UTILS-1.1.0.22/repos/centos7/HDP-UTILS-1.1.0.22-centos7.tar.gz" target="_blank" rel="noopener">点我</a></td></tr></tbody></table><h6 id="步骤2-上传到需要安装-Ambari-的机器上，解压到-httpd-的服务器目录中"><a href="#步骤2-上传到需要安装-Ambari-的机器上，解压到-httpd-的服务器目录中" class="headerlink" title="步骤2 上传到需要安装 Ambari 的机器上，解压到 httpd 的服务器目录中"></a>步骤2 上传到需要安装 Ambari 的机器上，解压到 httpd 的服务器目录中</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /var/www/html</span><br><span class="line">mkdir hdp ambari</span><br><span class="line">tar zxvf &lt;你上传的路径&gt;/ambari-2.6.2.2-centos7.tar.gz -C /var/www/html/ambari</span><br><span class="line">tar zxvf &lt;你上传的路径&gt;/HDP-2.6.5.0-centos7-rpm.tar.gz -C /var/www/html/hdp</span><br><span class="line">tar zxvf &lt;你上传的路径&gt;/HDP-UTILS-1.1.0.22-centos7.tar.gz -C /var/www/html/hdp</span><br></pre></td></tr></table></figure><h6 id="步骤3-使用-createrepo-工具配置生成源描述文件-可省略，会影响后续-repo-文件的路径配置"><a href="#步骤3-使用-createrepo-工具配置生成源描述文件-可省略，会影响后续-repo-文件的路径配置" class="headerlink" title="步骤3 使用 createrepo 工具配置生成源描述文件(可省略，会影响后续 repo 文件的路径配置)"></a>步骤3 使用 createrepo 工具配置生成源描述文件(可省略，会影响后续 repo 文件的路径配置)</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /var/www/html/ambari</span><br><span class="line">createrepo ./</span><br><span class="line">cd /var/www/html/hdp</span><br><span class="line">createrepo ./</span><br></pre></td></tr></table></figure><h6 id="步骤4-下载-HDP-和-Ambari-的-yum-repo-文件"><a href="#步骤4-下载-HDP-和-Ambari-的-yum-repo-文件" class="headerlink" title="步骤4 下载 HDP 和 Ambari 的 yum repo 文件"></a>步骤4 下载 HDP 和 Ambari 的 yum repo 文件</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/yum.repos.d</span><br><span class="line">wget -nv http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.5.0/hdp.repo</span><br><span class="line">wget -nv http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.6.2.2/ambari.repo</span><br></pre></td></tr></table></figure><h6 id="步骤5-配置-yum-repo-文件指向本地的软件源"><a href="#步骤5-配置-yum-repo-文件指向本地的软件源" class="headerlink" title="步骤5 配置 yum repo 文件指向本地的软件源"></a>步骤5 配置 yum repo 文件指向本地的软件源</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/yum.repos.d/ambari.repo</span><br><span class="line">## 更改 baseurl 和 gpgcheck 两项</span><br><span class="line">baseurl=http:///&lt;你的主机名&gt;/ambari</span><br><span class="line">gpgcheck=0</span><br><span class="line"></span><br><span class="line">vi /etc/yum.repos.d/hdp.repo ## 根据步骤3，HDP 和 HDP-UTILS 可以使用同一个 baseurl</span><br><span class="line">## 更改 baseurl 和 gpgcheck 两项</span><br><span class="line">baseurl=http:///&lt;你的主机名&gt;/hdp</span><br><span class="line">gpgcheck=0</span><br></pre></td></tr></table></figure><h6 id="步骤6-刷新软件源"><a href="#步骤6-刷新软件源" class="headerlink" title="步骤6 刷新软件源"></a>步骤6 刷新软件源</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br><span class="line">## 如果此过程出现 404 错误，检查 httpd 服务是否正常，或者步骤3</span><br></pre></td></tr></table></figure><h2 id="安装、配置、启动与登录"><a href="#安装、配置、启动与登录" class="headerlink" title="安装、配置、启动与登录"></a>安装、配置、启动与登录</h2><p>此过程较为简单。</p><h6 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install ambari-server</span><br></pre></td></tr></table></figure><h6 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ambari-server setup</span><br><span class="line">其中可以配置是否创建用户、JDK、Ambari 自用元数据库（默认 Postgre）等，可以选择一路回车。</span><br></pre></td></tr></table></figure><h6 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service ambari-server start</span><br></pre></td></tr></table></figure><h6 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h6><p>访问 <code>http://&lt;你的主机 IP 地址&gt;:8080/</code>，使用默认的 <code>admin/admin</code> 账户登录即可。</p><p>使用 Ambari 安装 hadoop 集群可以参考另外一篇博文<a href="/2018/10/13/使用 Ambari 安装 HDP 集群">使用 Ambari 安装 hadoop 集群</a>。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;版本说明&quot;&gt;&lt;a href=&quot;#版本说明&quot; class=&quot;headerlink&quot; title=&quot;版本说明&quot;&gt;&lt;/a&gt;版本说明&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;部件&lt;/th&gt;
&lt;th&gt;版本号&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbo
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="centos7" scheme="https://snzhaoyua.github.io/tags/centos7/"/>
    
      <category term="ambari" scheme="https://snzhaoyua.github.io/tags/ambari/"/>
    
      <category term="BigData" scheme="https://snzhaoyua.github.io/tags/BigData/"/>
    
  </entry>
  
  <entry>
    <title>在 Asciidoc 文档中使用 latex</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181106%20%E5%9C%A8%20Asciidoc%20%E6%96%87%E6%A1%A3%E4%B8%AD%E4%BD%BF%E7%94%A8%20latex/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181106 在 Asciidoc 文档中使用 latex/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.622Z</updated>
    
    <content type="html"><![CDATA[<div id="preamble"><div class="sectionbody"><div class="paragraph"><p>本文基于 asciidoctor 1.5.7.13，其通过 mathjax 实现 LaTex 字体的显示，方法和 markdown 差不多，区别是 markdown（不同差距实现方法不同）使用 $$ 或者 $``$ 包围 LaTex 语法，而 asciidoctor 使用 stem:[] 包围 LaTex 语法。</p></div><table class="tableblock frame-all grid-all spread"><caption class="title">Table 1. 单个符号对照表</caption><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">渲染后</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">源码</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\cdot\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\cdot]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\times\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\times]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(a^&#123;\prime&#125; a\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[a^&#123;\prime&#125; a]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(a’’\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[a’’]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\hat&#123;a&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\hat&#123;a&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\bar&#123;a&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\bar&#123;a&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\grave&#123;a&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\grave&#123;a&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\acute&#123;a&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\acute&#123;a&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\dot&#123;a&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\dot&#123;a&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\ddot&#123;a&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\ddot&#123;a&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\not&#123;a&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\not&#123;a&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\mathring&#123;a&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\mathring&#123;a&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\overrightarrow&#123;AB&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\overrightarrow&#123;AB&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\overleftarrow&#123;AB&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\overleftarrow&#123;AB&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(a’’’\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[a’’’]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\overline&#123;aaa&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\overline&#123;aaa&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\check&#123;a&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\check&#123;a&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\vec&#123;a&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\vec&#123;a&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\underline&#123;a&#125;\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\underline&#123;a&#125;]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\color&#123;red&#125;x\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\color&#123;red&#125;x]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\pm\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\pm]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\mp\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\mp]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\int y \mathrm&#123;d&#125;x\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\int y \mathrm&#123;d&#125;x]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(!\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[!]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\int y\, \mathrm&#123;d&#125;x\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\int y\, \mathrm&#123;d&#125;x]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\dots\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\dots]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\ldots\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\ldots]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\cdots\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\cdots]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\vdots\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\vdots]</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">\(\ddots\)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">stem:[\ddots]</p></td></tr></tbody></table><table class="tableblock frame-all grid-all spread"><caption class="title">Table 2. 行列式</caption><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">渲染后</th><th class="tableblock halign-left valign-top">源码</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="stemblock"><div class="content">\[\vec&#123;a&#125; = \left[\begin&#123;array&#125;&#123;rrrr&#125;   15\\   7 \end&#123;array&#125;\right)\]</div></div></div></td><td class="tableblock halign-left valign-top"><div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-latex" data-lang="latex">\vec&#123;a&#125; =\left[\begin&#123;array&#125;&#123;rrrr&#125;  (1)  15\\  7\end&#123;array&#125;\right)         (2)</code></pre></div></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="stemblock"><div class="content">\[\begin&#123;cases&#125; \ u_&#123;tt&#125;(x,t)= b(t)\triangle u(x,t-4)&amp;\\\ \hspace&#123;42pt&#125;- q(x,t)f[u(x,t-3)]+te^&#123;-t&#125;\sin^2 x,  &amp;  t \neq t_k; \\ \ u(x,t_k^+) - u(x,t_k^-) = c_k u(x,t_k), &amp; k=1,2,3\ldots ;\\ \ u_&#123;t&#125;(x,t_k^+) - u_&#123;t&#125;(x,t_k^-) =c_k u_&#123;t&#125;(x,t_k), &amp; k=1,2,3\ldots\ .\end&#123;cases&#125;]\]</div></div></div></td><td class="tableblock halign-left valign-top"><div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-latex" data-lang="latex">[latexmath]++++\begin&#123;cases&#125; \ u_&#123;tt&#125;(x,t)= b(t)\triangle u(x,t-4)&amp;\\\ \hspace&#123;42pt&#125;- q(x,t)f[u(x,t-3)]+te^&#123;-t&#125;\sin^2 x,  &amp;  t \neq t_k; \\ \ u(x,t_k^+) - u(x,t_k^-) = c_k u(x,t_k), &amp; k=1,2,3\ldots ;\\ \ u_&#123;t&#125;(x,t_k^+) - u_&#123;t&#125;(x,t_k^-) =c_k u_&#123;t&#125;(x,t_k), &amp; k=1,2,3\ldots\ .\end&#123;cases&#125;]++++</code></pre></div></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="stemblock"><div class="content">\[q(x,t)=\begin&#123;cases&#125;(t-k+1)x^2,\quad \ \ &amp;  t\in\big(k-1,k-\dfrac&#123;1&#125;&#123;2&#125;\big],\\  (k-t)x^2, \quad \ \ &amp; t\in\big(k-\dfrac&#123;1&#125;&#123;2&#125;,k\big],\end&#123;cases&#125;\]</div></div></div></td><td class="tableblock halign-left valign-top"><div><div class="listingblock"><div class="content"><pre class="highlight"><code class="language-latex" data-lang="latex">q(x,t)=\begin&#123;cases&#125;(t-k+1)x^2,\quad \ \ &amp;  t\in\big(k-1,k-\dfrac&#123;1&#125;&#123;2&#125;\big],\\  (k-t)x^2, \quad \ \ &amp; t\in\big(k-\dfrac&#123;1&#125;&#123;2&#125;,k\big],\end&#123;cases&#125;</code></pre></div></div></div></td></tr></tbody></table></div></div><div class="sect1"><h2 id="_hexo中集成asciidoctor后渲染latex的bug">hexo中集成asciidoctor后渲染latex的bug</h2><div class="sectionbody"><div class="paragraph"><p>hexo, asciidoctor, latex 三者在一起组成了一个很小众的东西。实际上使用 ruby 安装的 asciidoctor 在使用起来完全没有问题，但是 hexo 中因为使用的是 nodejs 中的一个 <a href="https://github.com/hcoona/hexo-renderer-asciidoc/" target="_blank" rel="noopener">hexo-renderer-asciidoc</a> 插件对 hexo 增强了 asciidoctor 的功能，并且该插件会对 <code>&#123;</code> <code>&#125;</code> 进行 <a href="https://github.com/hcoona/hexo-renderer-asciidoc/blob/fc64b0e493ed81267c9573ef78b27523f2291018/lib/renderer.js#L33" target="_blank" rel="noopener">转义</a>，因此会导致莫名其妙的 <a href="https://github.com/hcoona/hexo-renderer-asciidoc/issues" target="_blank" rel="noopener">问题</a>出现。</p></div><div class="paragraph"><p>另外 hexo 的 theme\next 主题中有 mathjax 的配置，将其设置为 true 后所有的页面都会引用 mathjax 的 js。</p></div><div class="listingblock"><div class="title">themes/next/_config.yml</div><div class="content"><pre class="highlight"><code class="language-yaml" data-lang="yaml"><span class="attr">mathjax:</span><span class="attr">  enable:</span> <span class="literal">true</span><span class="attr">  per_page:</span> <span class="literal">false</span><span class="attr">  cdn:</span> <span class="string">//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML</span></code></pre></div></div><div class="paragraph"><p>因此开启此项配置后，结合插件，页面上的 LaTex 公式就可以正常显示了。</p></div></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;本文基于 asciidoctor 1.5.7.13，其通过 mathjax 实现 LaTex 字体的显示，方法和 markdown 差
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="Asciidoctor" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/Asciidoctor/"/>
    
    
      <category term="Asciidoctor" scheme="https://snzhaoyua.github.io/tags/Asciidoctor/"/>
    
      <category term="线性代数" scheme="https://snzhaoyua.github.io/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181010%20hello-world/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181010 hello-world/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.618Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>mysql 访问常见问题</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181229%20mysql%20%E8%AE%BF%E9%97%AE%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181229 mysql 访问常见问题/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.622Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>配置文件参见[如何确定 mysql 的配置文件](待补充)</p></div><div class="qlist qanda"><ol><li><p><em>只能从本机访问</em></p><p>lsof -i:3306 查看发现，mysql 只监听本机。解决：以我本机为例，在 /etc/mysql/mysql.conf.d/mysqld.cnf 中，将以下行注释掉</p><div class="literalblock"><div class="content"><pre>bind-address:127.0.0.1</pre></div></div></li><li><p><em>无法从外部机器使用某一用户访问</em></p><p>登陆 mysql，创建远程访问用户，以 root 为例。</p><div class="literalblock"><div class="content"><pre>mysql&gt; `grant all privileges on *.* to 'root'@'%' identified by 'password' with grant option;`</pre></div></div></li></ol></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;配置文件参见[如何确定 mysql 的配置文件](待补充)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;qlist qanda&quot;&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;em&gt;只能从本机访问&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;lsof -i:3
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="技术" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="MySQL" scheme="https://snzhaoyua.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>线性代数快速复习[双语]</title>
    <link href="https://snzhaoyua.github.io/2019/09/22/2018/20181216%20%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E5%BF%AB%E9%80%9F%E5%A4%8D%E4%B9%A0%5B%E5%8F%8C%E8%AF%AD%5D/"/>
    <id>https://snzhaoyua.github.io/2019/09/22/2018/20181216 线性代数快速复习[双语]/</id>
    <published>2019-09-22T04:56:05.252Z</published>
    <updated>2019-09-19T03:41:58.622Z</updated>
    
    <content type="html"><![CDATA[<div class="dlist"><dl><dt class="hdlist1">向量加法与数乘 Addition and Scalar Multiplication</dt></dl></div><div class="stemblock left_mathjax"><div class="content">\[\vec&#123;a&#125; =\left[\begin&#123;array&#125;&#123;rrrr&#125;  x\\  y\end&#123;array&#125;\right],\vec&#123;b&#125; =\left[\begin&#123;array&#125;&#123;rrrr&#125;  m\\  n\end&#123;array&#125;\right]\\\vec&#123;a&#125;+\vec&#123;b&#125;=\left[\begin&#123;array&#125;&#123;rrrr&#125;  x+m\\  y+n\end&#123;array&#125;\right]\\2\vec&#123;a&#125;=\left[\begin&#123;array&#125;&#123;rrrr&#125;  2x\\  2y\end&#123;array&#125;\right]\]</div></div><div class="dlist"><dl><dt class="hdlist1">向量的线性组合，向量张成的空间，基向量 Linear Combination, Span, bases</dt><dd><p>\(a\vec&#123;i&#125; + b\vec&#123;j&#125; \quad a,b 取所有实数\)</p></dd><dt class="hdlist1">线性相关 Linear Dependent</dt><dd><p>\(\vec&#123;v&#125; = b\vec&#123;w&#125; \quad 增加一个线性相关的向量，不会增加张成的空间\)</p><div class="paragraph"><p>所以向量空间的基，是可以张成该空间的一组线性无关的向量(的集合)</p></div><div class="paragraph"><p>A basis of a vector space is a set of linear independent vectors that span the full space.</p></div></dd><dt class="hdlist1">线性变换 Linear Transformation</dt><dd><p>把\(\left(\begin&#123;array&#125;&#123;rrrr&#125;  x_1 &amp; x_2\\  y_1 &amp; y_2\end&#123;array&#125;\right)\)看作是经过线性变换后的基向量组成的矩阵，其中\(\vec&#123;i&#125;=\left(\begin&#123;array&#125;&#123;rrrr&#125;  x_1\\  y_1\end&#123;array&#125;\right)\),\(\vec&#123;j&#125;=\left(\begin&#123;array&#125;&#123;rrrr&#125;  x_2\\  y_2\end&#123;array&#125;\right)\)，而\(a_&#123;input&#125;\left(\begin&#123;array&#125;&#123;rrrr&#125;   x_1\\   y_1 \end&#123;array&#125;\right)+b_&#123;input&#125;\left(\begin&#123;array&#125;&#123;rrrr&#125;    x_2\\    y_2  \end&#123;array&#125;\right)\)就可以看作用矩阵对\(\left(\begin&#123;array&#125;&#123;rrrr&#125;  a_&#123;input&#125;\\  b_&#123;input&#125;\end&#123;array&#125;\right)\)做变换。</p><div class="paragraph"><p>更形象的表示，就是</p></div><div class="stemblock"><div class="content">\[\left[\begin&#123;array&#125;&#123;llll&#125;  a_&#123;input&#125;\\  b_&#123;input&#125;\end&#123;array&#125;\right]\toa_&#123;input&#125;\left[\begin&#123;array&#125;&#123;rrrr&#125;   x_1\\   y_1 \end&#123;array&#125;\right]+b_&#123;input&#125;\left[\begin&#123;array&#125;&#123;rrrr&#125;    x_2\\    y_2  \end&#123;array&#125;\right]=\left[\begin&#123;array&#125;&#123;llll&#125;  a_&#123;input&#125;x_1+b_&#123;input&#125;x_2\\  a_&#123;input&#125;y_1+b_&#123;input&#125;y_2\end&#123;array&#125;\right]=\left[\begin&#123;array&#125;&#123;llll&#125;  a_&#123;output&#125;\\  a_&#123;output&#125;\end&#123;array&#125;\right]\]</div></div></dd><dt class="hdlist1">举例，如何描述将一个坐标轴逆时针旋转\(90^&#123;\circ&#125;\)呢？</dt><dd><p>假设原空间的基础向量为\(\vec&#123;i&#125;=\left(\begin&#123;array&#125;&#123;llll&#125;  1\\  0\end&#123;array&#125;\right)\),\(\vec&#123;j&#125;=\left(\begin&#123;array&#125;&#123;llll&#125;  0\\  1\end&#123;array&#125;\right)\)。那么旋转90<sup>\(\circ\)</sup>后，\(\vec&#123;i&#125;\)和\(\vec&#123;j&#125;\)变成了\(\vec&#123;i_&#123;new&#125;&#125;=\left(\begin&#123;array&#125;&#123;llll&#125;  0\\  1\end&#123;array&#125;\right)\),\(\vec&#123;j_&#123;new&#125;&#125;=\left(\begin&#123;array&#125;&#123;llll&#125;  -1\\  0\end&#123;array&#125;\right)\)。可以画一张图来帮助理解。</p><div class="paragraph"><p>那么对于任意一个向量\(\vec&#123;v&#125;=a\vec&#123;i&#125;+b\vec&#123;j&#125;\)，其变换后的向量就可以用\(\left(\begin&#123;array&#125;&#123;llll&#125;  \vec&#123;i_&#123;new&#125;&#125;&amp;\vec&#123;j_&#123;new&#125;&#125;\end&#123;array&#125;\right)\cdot\vec&#123;v&#125;\)即\(  a\cdot\vec&#123;i_&#123;new&#125;&#125;+b\cdot\vec&#123;j_&#123;new&#125;&#125;\)表示。</p></div><div class="paragraph"><p>这种思想，也可以理解为，将变换后的基向量重新数乘后相加。</p></div></dd><dt class="hdlist1">矩阵与向量相乘</dt><dd><p>由上得出，矩阵与向量相乘计算公式为</p></dd></dl></div><div class="stemblock"><div class="content">\[\left[\begin&#123;array&#125;&#123;llll&#125;x_1 &amp; x_2\\y_1 &amp; y_2\end&#123;array&#125;\right]\left(\begin&#123;array&#125;&#123;llll&#125;a\\b\end&#123;array&#125;\right)=a\cdot\left(\begin&#123;array&#125;&#123;llll&#125;      x_1\\      y_1      \end&#123;array&#125;\right)+b\cdot\left(\begin&#123;array&#125;&#123;llll&#125;      x_2\\      y_2      \end&#123;array&#125;\right)=\left(\begin&#123;array&#125;&#123;llll&#125;ax_1+bx_2\\ay_1+by_2\end&#123;array&#125;\right)\]</div></div><div class="dlist"><dl><dt class="hdlist1">矩阵与矩阵相乘</dt><dd><p>矩阵和矩阵相乘的几何意义，就是描述两个（或以上）线性变换的组合效果，并且最先变换的矩阵在最右边。</p><div class="paragraph"><p>对于\(\left(\begin&#123;array&#125;&#123;llll&#125;\vec&#123;i_&#123;second&#125;&#125; &amp; \vec&#123;j_&#123;second&#125;&#125;\end&#123;array&#125;\right)\left(\begin&#123;array&#125;&#123;llll&#125;\vec&#123;i_&#123;first&#125;&#125; &amp; \vec&#123;j_&#123;first&#125;&#125;\end&#123;array&#125;\right)\)，可以考察最左侧变换，分别对\(\vec&#123;i_&#123;first&#125;&#125;\)，\(\vec&#123;i_&#123;first&#125;&#125;\)的影响，由此得出矩阵相乘公式为</p></div><div class="stemblock"><div class="content">\[\left(\begin&#123;array&#125;&#123;llll&#125;\vec&#123;i_&#123;second&#125;&#125; &amp; \vec&#123;j_&#123;second&#125;&#125;\end&#123;array&#125;\right)\left(\begin&#123;array&#125;&#123;llll&#125;\vec&#123;i_&#123;first&#125;&#125; &amp; \vec&#123;j_&#123;first&#125;&#125;\end&#123;array&#125;\right)=\left[\begin&#123;array&#125;&#123;llll&#125;\left(\begin&#123;array&#125;&#123;llll&#125;\vec&#123;i_&#123;second&#125;&#125; &amp; \vec&#123;j_&#123;second&#125;&#125;\end&#123;array&#125;\right)\vec&#123;i_&#123;first&#125;&#125;&amp;\left(\begin&#123;array&#125;&#123;llll&#125;\vec&#123;i_&#123;second&#125;&#125; &amp; \vec&#123;j_&#123;second&#125;&#125;\end&#123;array&#125;\right)\vec&#123;j_&#123;first&#125;&#125;\end&#123;array&#125;\right]\]</div></div><div class="paragraph"><p>通用写法即为</p></div></dd></dl></div><div class="stemblock"><div class="content">\[\left[\begin&#123;array&#125;&#123;llll&#125;a &amp; b\\c &amp; d\end&#123;array&#125;\right]\left[\begin&#123;array&#125;&#123;llll&#125;e &amp; f\\g &amp; h\end&#123;array&#125;\right]=\left[\begin&#123;array&#125;&#123;llll&#125;ae+bg &amp; af+bf\\ce+dg &amp; cf+df\end&#123;array&#125;\right]\]</div></div><div class="admonitionblock note"><table><tr><td class="icon"><div class="title">Note</div></td><td class="content"><div class="paragraph"><p>\(AB \neq BA\\A(BC)=(AB)C\)</p></div></td></tr></table></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;dlist&quot;&gt;
&lt;dl&gt;
&lt;dt class=&quot;hdlist1&quot;&gt;向量加法与数乘 Addition and Scalar Multiplication&lt;/dt&gt;
&lt;/dl&gt;
&lt;/div&gt;
&lt;div class=&quot;stemblock left_mathjax
      
    
    </summary>
    
      <category term="备忘" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/"/>
    
      <category term="数学" scheme="https://snzhaoyua.github.io/categories/%E5%A4%87%E5%BF%98/%E6%95%B0%E5%AD%A6/"/>
    
    
      <category term="线性代数" scheme="https://snzhaoyua.github.io/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/"/>
    
      <category term="机器学习" scheme="https://snzhaoyua.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
</feed>
